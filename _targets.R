################################################################################
# Ker_Arctgazella-prey-scats project
# Lola Gilbert lola.gilbert@univ-lr.fr
#
# July 2022
# _targets.R
#
# Script decomposing with all steps of the analysis with target
################################################################################

library("targets")


# Source all functions contained in all files in the R directory
lapply(list.files(here::here("R"),
                  recursive = TRUE, full.names = T),
       source)


list(
  #################### RESULTS : SAMPLE COMPOSITION ############################
  # define and load results of composition of fish samples
  tar_target(res_compo_fish_file,
             "data/res_compo_fish.xlsx", 
             format = "file"),
  tar_target(res_compo_fish, # add campaign data
             load_xl(res_compo_fish_file)),
  
  # define and load results of composition of scats 
  tar_target(res_compo_scats_file,
             "data/res_compo_scats.xlsx", 
             format = "file"),
  tar_target(res_compo_scats, load_xl(res_compo_scats_file)), 
  
  #################### DATA : SAMPLES & DIET ###################################
  # script 01_summarize_data_samples.R
  ##### 1 - on fish samples 
  # define and load data on samples of fish
  tar_target(data_fish_file,
             "data/data_fish_YC.xlsx", 
             format = "file"),
  tar_target(data_fish_samples, load_xl(data_fish_file)),
  # summarize data on samples 
  tar_target(data_fish_summary, summary_fish_samples(data_fish_samples, 
                                                     res_compo_fish)),
  
  ##### 2 - on scats
  # define and load data on samples of scats
  tar_target(data_scat_file,
             "data/data_scats.xlsx", 
             format = "file"),
  tar_target(data_scat_samples, load_xl(data_scat_file)),
  # summarize data on samples 
  tar_target(data_scat_summary, summary_scat_samples(data_scat_samples)),
  
  ##### 3 - on diet of Arctocephalus gazella
  tar_target(data_diet_file, 
             "data/data_diet_Agazella.xlsx", 
             format = "file"), 
  tar_target(data_diet, load_xl(data_diet_file)),
  # summarize data on diets 
  tar_target(data_diet_summary, summary_diet_data(data_diet, 
                                                  res_compo_fish)),
  
  ####### IDENTIFY ANALYTICAL OUTLIERS + POTENTIAL CONTAMINATION ###############
  ###### samples identified with adnormal values must be treated independently 
  # with several possibilities: 
  # - if they display adnormal values for a majority of nutrients (more than 7), 
  #   there must have been a contamination during sample preparation ----> 
  #   THESE ARE REMOVED 
  # - if not, then analysis can be rerun for same samples, 2 possible outcomes 
  #       - value is back into "normal" range --> REPLACE ODD VALUE WITH NEW ONE
  #       - values is still "abnormal" --> KEEP SAMPLE FOR CHARACTERIZATION OF 
  #                                       COMPOSITION OF SAMPLE AND FOR 
  #                                       STATISTICAL ANALYSIS REPLACE VALUE 
  #                                       WITH VALUE OF HIGHER QUANTILE (97.5 %) 
  #                                       OF OTHER SAMPLES FOR SAME ELEMENT
  # script 02_id_technical_outliers.R
  
  # -------------- FISH ------------------
  # identify outliers
  # statistical outliers
  tar_target(boxplot_outliers_fish_stats, 
             boxplot_id_outliers_stats(res_compo_fish, 
                                       "fish")), # boxplot
  tar_target(tib_outliers_fish_stats, 
             tib_id_outliers(res_compo_fish, 
                             data_fish_samples, 
                             "fish", "fish_id_outliers")), # tibble
  # technical outliers 
  tar_target(hist_outliers_fish_tech, 
             hist_id_outliers(res_compo_fish, "fish")), # histograms
  ### two samples identified as potentially contaminated during sample preparation
  ### other samples identified with high values for just a few elements were rerun for analysis
  ### and values were confirmed: they are kept as is, eventually to modify for statistical analysis
  # get rid of technical outliers + add campaign data 
  # format by adding campaign data and identify sp of prey included in diet of Agazella
  # & remove contaminated samples (2005_PROTAND_PA03 & 2010PII_ARCTRIS_CHA94_AR01)
  # & remove unwanted elements
  tar_target(res_compo_fish_notechoutliers, res_compo_fish |> 
               dplyr::filter(!(Code_sample %in% c("2005_PROTAND_PA03",
                                                  "2010PII_ARCTRIS_CHA94_AR01"))) |>
               dplyr::select(-c(Mo, V, Ag, Cr, Pb, Cd, Sr))) ,
  
  # --------------- SCATS -------------------
  # statistical outliers
  tar_target(boxplot_outliers_scats_stats, 
             boxplot_id_outliers_stats(res_compo_scats, 
                                       "scat")), # boxplot
  tar_target(tib_outliers_scats_stats, 
             tib_id_outliers(res_compo_scats,
                             data_samples, 
                             "scat", "scats_id_outliers")), # tibble
  # technical outliers 
  tar_target(hist_outliers_scats_tech, 
             hist_id_outliers(res_compo_scats, "scat")), # histogram
  # remove contaminated samples (CN12 & CN02) and unwanted elements
  tar_target(res_compo_scats_nooutliers, res_compo_scats |>
               dplyr::select(-c(Mo, V, Ag, Cr, Pb, Cd, Sr)) |>
               dplyr::mutate(site = dplyr::case_when(stringr::str_starts(Code_sample, 
                                                                         "CN") ~ "Cap Noir", 
                                                     stringr::str_starts(Code_sample, 
                                                                         "PS") ~ "Pointe Suzanne")) |>
               dplyr::filter(!(Code_sample %in% c("CN12", "CN02")))),
  
  
  ################### DESCRIBE COMPOSITION ######################################
  # scripts 03_compute_diet_compo.R and 04_description_compo.R
  
  # ------------- FISH ---------------------
  tar_target(table_summary_compo_fish_sp_output, 
             table_compo_fish_sp(res_compo_fish_notechoutliers, 
                                 "output")),
  tar_target(table_summary_compo_fish_sp_file, 
             table_compo_fish_sp(res_compo_fish_notechoutliers, 
                                 "file")),
  
  # add habitat and indicate species identified as prey species of A. gazella
  tar_target(full_res_compo_fish, complete_fish_data(res_compo_fish_notechoutliers, 
                                                     data_diet)),
  
  # all fish samples together 
  tar_target(boxplot_fish_tot, boxplot_compo_fish_tot(full_res_compo_fish)),
  tar_target(densplot_fish_tot, densplot_compo_fish_tot(full_res_compo_fish)), 
  
  # per species and per nutrient
  # compute mean per species first
  tar_target(fish_sp_means_tot, compute_means_sp(full_res_compo_fish)),
  # boxplots
  tar_target(boxplot_fish_sp_As, 
             boxplot_compo_fish_sp(full_res_compo_fish, "As")),
  tar_target(boxplot_fish_sp_Ca, 
             boxplot_compo_fish_sp(full_res_compo_fish, "Ca")),
  tar_target(boxplot_fish_sp_Co, 
             boxplot_compo_fish_sp(full_res_compo_fish, "Co")),
  tar_target(boxplot_fish_sp_Cu, 
             boxplot_compo_fish_sp(full_res_compo_fish, "Cu")),
  tar_target(boxplot_fish_sp_Fe, 
             boxplot_compo_fish_sp(full_res_compo_fish, "Fe")),
  tar_target(boxplot_fish_sp_K, 
             boxplot_compo_fish_sp(full_res_compo_fish, "K")),
  tar_target(boxplot_fish_sp_Mg, 
             boxplot_compo_fish_sp(full_res_compo_fish, "Mg")),
  tar_target(boxplot_fish_sp_Mn, 
             boxplot_compo_fish_sp(full_res_compo_fish, "Mn")),
  tar_target(boxplot_fish_sp_Na, 
             boxplot_compo_fish_sp(full_res_compo_fish, "Na")),
  tar_target(boxplot_fish_sp_Ni, 
             boxplot_compo_fish_sp(full_res_compo_fish, "Ni")),
  tar_target(boxplot_fish_sp_P, 
             boxplot_compo_fish_sp(full_res_compo_fish, "P")),
  tar_target(boxplot_fish_sp_Se, 
             boxplot_compo_fish_sp(full_res_compo_fish, "Se")),
  tar_target(boxplot_fish_sp_Zn, 
             boxplot_compo_fish_sp(full_res_compo_fish, "Zn")),
  
  # per species for all nutrients
  tar_target(boxplot_fish_sp_all_nut, 
             boxplot_compo_fish_sp_all_nut(full_res_compo_fish)),
  # version with only mean and quantiles
  tar_target(boxplot_fish_sp_all_nut_grad, 
             boxplot_compo_fish_sp_all_nut_grad(full_res_compo_fish)),
  
  # version with only mean and quantiles but only one nut
  tar_target(boxplot_fish_sp_nut_grad_Fe, 
             boxplot_compo_fish_sp_one_nut_grad(full_res_compo_fish, 
                                                "Fe")),
  tar_target(boxplot_fish_sp_nut_grad_P, 
             boxplot_compo_fish_sp_one_nut_grad(full_res_compo_fish, 
                                                "P")),
  tar_target(boxplot_fish_sp_nut_grad_Zn, 
             boxplot_compo_fish_sp_one_nut_grad(full_res_compo_fish, 
                                                "Zn")),
  tar_target(boxplot_fish_sp_nut_grad_As, 
             boxplot_compo_fish_sp_one_nut_grad(full_res_compo_fish, 
                                                "As")),
  tar_target(boxplot_fish_sp_nut_grad_Fe_spna, 
             boxplot_compo_fish_sp_one_nut_grad_sp(full_res_compo_fish, 
                                                   "Fe")),
  tar_target(boxplot_fish_sp_nut_grad_P_spna, 
             boxplot_compo_fish_sp_one_nut_grad_sp(full_res_compo_fish, 
                                                   "P")),
  tar_target(boxplot_fish_sp_nut_grad_Zn_spna, 
             boxplot_compo_fish_sp_one_nut_grad_sp(full_res_compo_fish, 
                                                   "Zn")),
  tar_target(boxplot_fish_sp_nut_grad_As_spna, 
             boxplot_compo_fish_sp_one_nut_grad_sp(full_res_compo_fish, 
                                                   "As")),
  # a version to get a good picture of the legend for the above
  tar_target(boxplot_fish_sp_nut_grad_legend, 
             boxplot_compo_fish_sp_one_nut_legend(full_res_compo_fish, 
                                                  "As")),
  
  
  # boxplots per genus and per nutrient
  tar_target(boxplot_fish_genus_As, 
             boxplot_compo_fish_genus(full_res_compo_fish, "As")),
  tar_target(boxplot_fish_genus_Ca, 
             boxplot_compo_fish_genus(full_res_compo_fish, "Ca")),
  tar_target(boxplot_fish_genus_Co, 
             boxplot_compo_fish_genus(full_res_compo_fish, "Co")),
  tar_target(boxplot_fish_genus_Cu,
             boxplot_compo_fish_genus(full_res_compo_fish, "Cu")),
  tar_target(boxplot_fish_genus_Fe, 
             boxplot_compo_fish_genus(full_res_compo_fish, "Fe")),
  tar_target(boxplot_fish_genus_K, 
             boxplot_compo_fish_genus(full_res_compo_fish, "K")),
  tar_target(boxplot_fish_genus_Mg, 
             boxplot_compo_fish_genus(full_res_compo_fish, "Mg")),
  tar_target(boxplot_fish_genus_Mn,
             boxplot_compo_fish_genus(full_res_compo_fish, "Mn")),
  tar_target(boxplot_fish_genus_Na, 
             boxplot_compo_fish_genus(full_res_compo_fish, "Na")),
  tar_target(boxplot_fish_genus_Ni, 
             boxplot_compo_fish_genus(full_res_compo_fish, "Ni")),
  tar_target(boxplot_fish_genus_P, 
             boxplot_compo_fish_genus(full_res_compo_fish, "P")),
  tar_target(boxplot_fish_genus_Se, 
             boxplot_compo_fish_genus(full_res_compo_fish, "Se")),
  tar_target(boxplot_fish_genus_Zn, 
             boxplot_compo_fish_genus(full_res_compo_fish, "Zn")),
  
  # per genus for all nutrients
  tar_target(boxplot_fish_genus_all_nut, 
             boxplot_compo_fish_genus_all_nut(full_res_compo_fish)),
  
  # boxplots per family and per nutrient
  tar_target(boxplot_fish_fam_As, 
             boxplot_compo_fish_fam(full_res_compo_fish, "As")),
  tar_target(boxplot_fish_fam_Ca, 
             boxplot_compo_fish_fam(full_res_compo_fish, "Ca")),
  tar_target(boxplot_fish_fam_Co, 
             boxplot_compo_fish_fam(full_res_compo_fish, "Co")),
  tar_target(boxplot_fish_fam_Cu, 
             boxplot_compo_fish_fam(full_res_compo_fish, "Cu")),
  tar_target(boxplot_fish_fam_Fe, 
             boxplot_compo_fish_fam(full_res_compo_fish, "Fe")),
  tar_target(boxplot_fish_fam_K, 
             boxplot_compo_fish_fam(full_res_compo_fish, "K")),
  tar_target(boxplot_fish_fam_Mg, 
             boxplot_compo_fish_fam(full_res_compo_fish, "Mg")),
  tar_target(boxplot_fish_fam_Mn, 
             boxplot_compo_fish_fam(full_res_compo_fish, "Mn")),
  tar_target(boxplot_fish_fam_Na, 
             boxplot_compo_fish_fam(full_res_compo_fish, "Na")),
  tar_target(boxplot_fish_fam_Ni, 
             boxplot_compo_fish_fam(full_res_compo_fish, "Ni")),
  tar_target(boxplot_fish_fam_P, 
             boxplot_compo_fish_fam(full_res_compo_fish, "P")),
  tar_target(boxplot_fish_fam_Se, 
             boxplot_compo_fish_fam(full_res_compo_fish, "Se")),
  tar_target(boxplot_fish_fam_Zn, 
             boxplot_compo_fish_fam(full_res_compo_fish, "Zn")),
  
  # per family for all nutrients
  tar_target(boxplot_fish_fam_all_nut, 
             boxplot_compo_fish_fam_all_nut(full_res_compo_fish)),
  # per family for some nutrients only
  tar_target(boxplot_fish_fam_few_nut, 
             boxplot_compo_fish_fam_few_nut(full_res_compo_fish, 
                                            nutrients = c("P", "Fe", "Mn", "Co"))),
  
  # # boxplots per campaign and per nutrient
  # fish samples were collected during two different fishing campaign
  # however, care must be taken when comparing differences between two campaigns
  # because species collected were different on the two : fish collected during
  # the first one (Isotopes 2005) are mainly Myctophids while there is much more
  # variability in the ecology of fish collected during the second campaign 
  # Poker II - and there are differences between families - see above
  tar_target(boxplot_fish_camp_As, 
             boxplot_compo_fish_camp(full_res_compo_fish, "As")),
  tar_target(boxplot_fish_camp_Ca, 
             boxplot_compo_fish_camp(full_res_compo_fish, "Ca")),
  tar_target(boxplot_fish_camp_Co, 
             boxplot_compo_fish_camp(full_res_compo_fish, "Co")),
  tar_target(boxplot_fish_camp_Cu, 
             boxplot_compo_fish_camp(full_res_compo_fish, "Cu")),
  tar_target(boxplot_fish_camp_Fe, 
             boxplot_compo_fish_camp(full_res_compo_fish, "Fe")),
  tar_target(boxplot_fish_camp_K, 
             boxplot_compo_fish_camp(full_res_compo_fish, "K")),
  tar_target(boxplot_fish_camp_Mg, 
             boxplot_compo_fish_camp(full_res_compo_fish, "Mg")),
  tar_target(boxplot_fish_camp_Mn, 
             boxplot_compo_fish_camp(full_res_compo_fish, "Mn")),
  tar_target(boxplot_fish_camp_Na, 
             boxplot_compo_fish_camp(full_res_compo_fish, "Na")),
  tar_target(boxplot_fish_camp_Ni, 
             boxplot_compo_fish_camp(full_res_compo_fish, "Ni")),
  tar_target(boxplot_fish_camp_P, 
             boxplot_compo_fish_camp(full_res_compo_fish, "P")),
  tar_target(boxplot_fish_camp_Se, 
             boxplot_compo_fish_camp(full_res_compo_fish, "Se")),
  tar_target(boxplot_fish_camp_Zn, 
             boxplot_compo_fish_camp(full_res_compo_fish, "Zn")),
  
  # per habitat for all nutrients
  tar_target(boxplot_fish_hab_all_nut, 
             boxplot_compo_fish_hab_all_nut(full_res_compo_fish)),
  # test difference between habitats (with mean per species)
  tar_target(MWtest_fish_hab_table, 
             MWtest_fish_hab(full_res_compo_fish)),
  
  # boxplot comparison between composition of prey species and not prey species 
  tar_target(lineplot_prey_vs_not_prey_abs, 
             boxplot_compare_compo_prey_not_prey_abs(full_res_compo_fish)),
  tar_target(lineplot_prey_vs_not_prey_rel, 
             boxplot_compare_compo_prey_not_prey_rel(full_res_compo_fish)),
  tar_target(boxplot_prey_vs_not_prey_abs, 
             boxplot_compare_compo_prey_not_prey_abs(full_res_compo_fish)),
  tar_target(boxplot_prey_vs_not_prey_rel, 
             boxplot_compare_compo_prey_not_prey_rel(full_res_compo_fish)),
  tar_target(barplot_prey_vs_not_prey_rel, 
             barplot_comp_nut_prey_not_prey(full_res_compo_fish)),
  # table with the stats
  tar_target(table_stats_prey_vs_not_prey_rel, 
             table_compare_compo_prey_not_prey_abs(full_res_compo_fish)),
  # stat tests of differences
  tar_target(MWtest_conc_prey_vs_not_prey_abs, 
             MWtest_compo_prey_not_prey_abs(full_res_compo_fish)),
  tar_target(MWtest_conc_prey_vs_not_prey_rel_trace_only, 
             MWtest_compo_prey_not_prey_rel_trace_only(full_res_compo_fish)),
  tar_target(MWtest_conc_prey_vs_not_prey_rel_all_nut, 
             MWtest_compo_prey_not_prey_rel_all_nut(full_res_compo_fish)),
  
  # correlation matrix plot
  tar_target(corrplot_fish, corr_compo_fish(full_res_compo_fish)),
  
  
  #-------------- SCATS -------------- 
  tar_target(table_summary_compo_scats_tot_output, 
             table_compo_scats_tot(res_compo_scats_nooutliers, 
                                   "output")),
  tar_target(table_summary_compo_scats_tot_file, 
             table_compo_scats_tot(res_compo_scats_nooutliers, 
                                   "file")),
  tar_target(table_summary_compo_scats_site_output, 
             table_compo_scats_site(res_compo_scats_nooutliers, 
                                    "output")),
  tar_target(table_summary_compo_scats_site_file, 
             table_compo_scats_site(res_compo_scats_nooutliers, 
                                    "file")),
  tar_target(full_res_compo_scats, complete_compo_scats(res_compo_scats_nooutliers, 
                                                        data_scat_samples)), 
  # table without scats suspected to be of pups, and the two full of hair
  tar_target(full_res_compo_scats_nopup, full_res_compo_scats |>
               dplyr::filter(!(Code_sample %in% c("PS04", "PS05", "PS10",
                                                  "PS22", "PS26", "CN10",
                                                  "CN23", "CN24",
                                                  "PS27", "PS02")))),
  # composition : total 
  tar_target(boxplot_scats_tot, boxplot_compo_scats_tot(full_res_compo_scats, 
                                                        "boxplot_compo_tot")), 
  tar_target(densplot_scats_tot, densplot_compo_scats_tot(full_res_compo_scats, 
                                                          "densplot_compo_tot")),
  # without pups'
  tar_target(boxplot_scats_nopup, boxplot_compo_scats_tot(full_res_compo_scats_nopup,
                                                          "boxplot_compo_tot_nopup")),
  tar_target(densplot_scats_nopup, densplot_compo_scats_tot(full_res_compo_scats_nopup,
                                                            "densplot_compo_tot_nopup")),
  # per site
  tar_target(boxplot_scats_sites, boxplot_compo_scats_site(full_res_compo_scats, 
                                                           "boxplot_compo_sites")),
  tar_target(boxplot_scats_sites_nopup, boxplot_compo_scats_site(full_res_compo_scats_nopup,
                                                                 "boxplot_compo_sites_nopup")),
  # pup suspicion and no pup suspicion
  tar_target(boxplot_scats_pup_nopup, boxplot_compo_scats_pups(full_res_compo_scats,
                                                               "boxplot_compo_pup_nopup")),
  # per hard part index
  tar_target(boxplot_scats_HPI, boxplot_compo_scats_HPI(full_res_compo_scats, 
                                                        "boxplot_compo_HPI")),
  tar_target(boxplot_scats_HPI01, boxplot_compo_scats_HPI01(full_res_compo_scats, 
                                                            "boxplot_compo_HPI01")),
  tar_target(boxplot_scats_HPI_nopup, boxplot_compo_scats_HPI(full_res_compo_scats_nopup,
                                                              "boxplot_compo_HPI_nopup")),
  tar_target(boxplot_scats_HPI01_nopup, boxplot_compo_scats_HPI01(full_res_compo_scats_nopup,
                                                                  "boxplot_compo_HPI01_nopup")),
  # hard part index and pup suspicion
  tar_target(boxplot_scats_HPI01_pup_or_nopup, boxplot_compo_scats_HPI01_pups(full_res_compo_scats,
                                                                              "boxplot_compo_HPI01_pup_or_nopup")),
  
  # test difference between sites 
  tar_target(MWtest_scats_sites_table, 
             MWtest_scats_sites(full_res_compo_scats, "pup")),
  tar_target(MWtest_scats_sites_nopup_table, 
             MWtest_scats_sites(full_res_compo_scats_nopup, "no_pup")),
  # test difference between scats of pups and other ones 
  tar_target(MWtest_scats_pup_nopup_table, 
             MWtest_scats_pup_nopup(full_res_compo_scats)),
  # test difference between scats with and without hard parts
  tar_target(MWtest_scats_HPI_table, 
             MWtest_scats_HPI(full_res_compo_scats, "pup")),
  tar_target(MWtest_scats_HPI_nopup_table, 
             MWtest_scats_HPI(full_res_compo_scats, "no_pup")),
  # test difference between scats of pups and other ones accounting for HPI01
  tar_target(MWtest_scats_HPI_pup_table, 
             MWtest_scats_HPI01_pup(full_res_compo_scats)),
  
  # correlation matrix plot
  tar_target(corrplot_scats, corr_compo_scats(full_res_compo_scats, 
                                              "corrplot_compo_scats")),
  tar_target(corrplot_scats_nopup, corr_compo_scats(full_res_compo_scats_nopup,
                                                    "corrplot_compo_scats_nopup")),
  
  # scatterplot or nut concentrations and % water
  tar_target(scatterplot_water_nut_scats, 
             scatterplot_compo_water_scats(full_res_compo_scats, 
                                           data_scat_samples)),
  
  ######## OF DIET OF A.GAZELLA #######
  tar_target(compo_prey_ww, dw_to_ww_prey(full_res_compo_fish, 
                                          data_fish_samples)),
  tar_target(conc_in_diet, compute_concentrations_in_diet(data_diet,
                                                          compo_prey_ww)), 
  tar_target(boxplot_compo_diets, boxplot_compo_diets_sources(conc_in_diet)),
  
  ##################### COMPARE COMPOSITIONS ###################################
  # script 05_compare_compo.R
  
  # with means per species for fish
  tar_target(fish_sp_means_and_scats, 
             pool_fish_sp_means_scat(full_res_compo_fish, 
                                     full_res_compo_scats)),
  # with means per species for fish and no pup suspicion in scats
  tar_target(fish_sp_means_and_scats_nopup, 
             pool_fish_sp_means_scat(full_res_compo_fish, 
                                     full_res_compo_scats_nopup)),
  
  # without means per species for fish 
  tar_target(fish_full_and_scats_nopup, 
             pool_fish_full_scat(full_res_compo_fish, 
                                 full_res_compo_scats_nopup)),
  tar_target(fish_full_and_scats, 
             pool_fish_full_scat(full_res_compo_fish, 
                                 full_res_compo_scats)),
  
  # table with fold change ratios between absolute concentrations in fish and scats
  tar_target(comp_ratios_fish_vs_scat_tables, 
             comp_ratios_fish_vs_scat(fish_sp_means_and_scats)),
  
  # table with with statistics for absolute concentrations in fish and scats
  tar_target(comp_stats_fish_vs_scat_table, 
             table_comparison_stats(fish_sp_means_and_scats)),
  
  
  # boxplot comparison between composition of fish and scats 
  tar_target(lineplot_fish_and_scats_abs, 
             lineplot_compare_compo_abs(fish_sp_means_and_scats, 
                                        "lineplot_comp_fish_scat_log")),
  tar_target(lineplot_fish_and_scats_nopup_abs, 
             lineplot_compare_compo_abs(fish_sp_means_and_scats_nopup, 
                                        "lineplot_comp_fish_scat_nopup_log")),
  tar_target(lineplot_fish_full_and_scats_nopup_abs, 
             lineplot_compare_compo_abs(fish_full_and_scats_nopup, 
                                        "lineplot_comp_fish_full_scat_nopup_log")),
  tar_target(lineplot_fish_and_scats_norm, 
             lineplot_compare_compo_norm(fish_sp_means_and_scats, 
                                         "lineplot_comp_fish_scat_norm")),
  tar_target(lineplot_fish_full_and_scats_norm, 
             lineplot_compare_compo_norm(fish_full_and_scats, 
                                         "lineplot_comp_fish_full_scat_norm")),
  tar_target(boxplot_fish_full_and_scats_norm, 
             boxplot_compare_compo_norm(fish_full_and_scats, 
                                        "boxplot_comp_fish_full_scat_norm")),
  # in relative, standardized per sample
  tar_target(boxplot_fish_and_scats_relative, 
             boxplot_compare_compo_fish_scat_relative(fish_sp_means_and_scats, 
                                                      "boxplot_comp_fish_scat_relative_log")),
  tar_target(boxplot_fish_and_scats_relative_nopup, 
             boxplot_compare_compo_fish_scat_relative(fish_sp_means_and_scats_nopup, 
                                                      "boxplot_comp_fish_scat_nopup_relative_log")),
  tar_target(boxplot_fish_full_and_scats_relative_nopup, 
             boxplot_compare_compo_fish_scat_relative(fish_full_and_scats_nopup, 
                                                      "boxplot_comp_fish_full_scat_nopup_relative_log")),
  # in relative, standardized per sample but just with trace elements
  tar_target(lineplot_fish_and_scats_relative_trace, 
             lineplot_compare_compo_fish_scat_relative_trace_only(fish_sp_means_and_scats, 
                                                                  "lineplot_comp_fish_scat_relative_trace")),
  tar_target(lineplot_fish_and_scats_relative_trace_nopup, 
             lineplot_compare_compo_fish_scat_relative_trace_only(fish_sp_means_and_scats_nopup, 
                                                                  "lineplot_comp_fish_scat_nopup_relative_trace")),
  # in relative, standardized per sample but just with major elements
  tar_target(boxplot_fish_and_scats_relative_major, 
             boxplot_compare_compo_fish_scat_relative_major_only(fish_sp_means_and_scats, 
                                                                 "boxplot_comp_fish_scat_relative_major")),
  tar_target(boxplot_fish_and_scats_relative_major_nopup, 
             boxplot_compare_compo_fish_scat_relative_major_only(fish_sp_means_and_scats_nopup, 
                                                                 "boxplot_comp_fish_scat_nopup_relative_major")),
  
  # comparison ratio trace nutrients/major nutrients 
  tar_target(boxplot_fish_and_scats_relative_major_vs_trace_nopup, 
             boxplot_compare_compo_fish_scat_relative_major_vs_trace(fish_sp_means_and_scats_nopup, 
                                                                     "boxplot_comp_fish_scat_nopup_trace_vs_major")),
  tar_target(boxplot_fish_and_scats_relative_major_vs_trace_tot, 
             boxplot_compare_compo_fish_scat_relative_major_vs_trace(fish_sp_means_and_scats, 
                                                                     "boxplot_comp_fish_scat_tot_trace_vs_major")),
  
  # density plot comparison between composition of fish and scats 
  tar_target(densplot_fish_and_scats_full, 
             densplot_compare_compo_full(fish_sp_means_and_scats, 
                                         "densplot_comp_fish_scat")),
  tar_target(densplot_fish_and_scats_nopup, 
             densplot_compare_compo_full(fish_sp_means_and_scats_nopup, 
                                         "densplot_comp_fish_scat_nopup")),
  
  # density plot comparison between composition of fish and scats 
  tar_target(densplot_fish_and_scats_norm_per_type, 
             densplot_compare_compo_full_norm_per_type(fish_sp_means_and_scats, 
                                                       "densplot_comp_fish_scat_norm_per_type")),
  tar_target(densplot_fish_full_and_scats_norm_per_type, 
             densplot_compare_compo_full_norm_per_type(fish_full_and_scats, 
                                                       "densplot_comp_fish_full_scat_norm_per_type")),
  
  
  # boxplot comparison between composition of fish and scats with only fish 
  # identified as prey species
  tar_target(boxplot_prey_and_scats, 
             boxplot_compare_compo_prey(fish_sp_means_and_scats,  
                                        "boxplot_comp_prey_scat_log")),
  tar_target(boxplot_prey_and_scats_nopup, 
             boxplot_compare_compo_prey(fish_sp_means_and_scats_nopup,  
                                        "boxplot_comp_prey_scat_nopup_log")),
  tar_target(boxplot_prey_and_scats_relative, 
             boxplot_compare_compo_prey_relative(fish_sp_means_and_scats,  
                                                 "boxplot_comp_prey_scat_relative_log")),
  tar_target(boxplot_prey_and_scats_relative_nopup, 
             boxplot_compare_compo_prey_relative(fish_sp_means_and_scats_nopup,  
                                                 "boxplot_comp_prey_scat_nopup_relative_log")),
  
  # barplot comparison between variability in nutrient composition of fish and 
  # scats, per nutrient 
  tar_target(barplot_cv_per_nu_comp, 
             barplot_cv_comp_nut(fish_sp_means_and_scats)),
  
  # Mann Whitney test of difference between absolute concentration of 
  # fish and scats
  tar_target(MWtest_conc_abs_fish_scats_table, 
             MWtest_conc_fish_scats(fish_sp_means_and_scats,  
                                    "tot")),
  tar_target(MWtest_conc_abs_fish_scats_nopup_table, 
             MWtest_conc_fish_scats(fish_sp_means_and_scats_nopup,  
                                    "nopup")),
  
  # Mann Whitney test of difference between relative concentration of 
  # fish and scats
  tar_target(MWtest_conc_rel_fish_scats_table, 
             MWtest_conc_rel_fish_scats(fish_sp_means_and_scats,  
                                        "tot")),
  tar_target(MWtest_conc_rel_fish_scats_nopup_table, 
             MWtest_conc_rel_fish_scats(fish_sp_means_and_scats_nopup,  
                                        "nopup")),
  
  # Mann Whitney test of difference between relative concentration of 
  # fish and scats but for trace nutrients only
  tar_target(MWtest_conc_rel_trace_only_fish_scats_tot_table, 
             MWtest_conc_rel_fish_scats_trace_only(fish_sp_means_and_scats,  
                                                   "tot")),
  
  ##################### REPLACE STATISTICAL OUTLIERS VALUES BEFORE #############
  ############################## STATISTICAL ANALYSIS ##########################
  # script 06_handle_stat_outliers.R
  
  # prepare all tables for statistical analysis 
  
  # ---------- FISH ----------------
  # with mean values per sp and handling of stat. outliers
  tar_target(compo_fish_clean, replace_outliers_conc(full_res_compo_fish)),
  tar_target(fish_sp_means_clean, compute_means_sp(compo_fish_clean)),
  
  # ----------- SCATS -----------------
  # no stat. outliers
  
  # ----- BOTH FISH AND SCATS ----------
  # with sp means for fish and scats with and without pup suspicion
  # both already computed for comparison in 
  # fish_sp_means_and_scats & fish_sp_means_and_scats_nopup
  # now version with stat. outliers handled for fish data 
  # with means per species for fish
  tar_target(fish_sp_means_clean_and_scats, pool_fish_sp_means_scat(compo_fish_clean, 
                                                                    full_res_compo_scats)),
  # with means per species for fish and no pup suspicion in scats
  tar_target(fish_sp_means_clean_and_scats_nopup, pool_fish_sp_means_scat(compo_fish_clean, 
                                                                          full_res_compo_scats_nopup)),
  
  ##################### PCA ####################################################
  # script 07_PCA.R
  
  #---------------- FISH -----------------------
  # PCA only conducted using means per species
  # robust CoDa PCA analysis 
  tar_target(PCA_fish_tot_coda_rob, pca_coda(fish_sp_means_tot, 
                                             "fish")),
  tar_target(biplot_PCA_fish_tot_coda_rob_fam, 
             biplot_pca_coda(PCA_fish_tot_coda_rob, 
                             fish_sp_means_tot, 
                             "fish_tot_coda_rob_PC12_fam",
                             pcomp = c(1:2), 
                             groups = "Family", 
                             var.add.scaling = 2.5,
                             ellipse = FALSE)),
  tar_target(biplot_PCA_fish_tot_coda_rob_fam_ell, 
             biplot_pca_coda(PCA_fish_tot_coda_rob, 
                             fish_sp_means_tot, 
                             "fish_tot_coda_rob_PC12_fam_ell",
                             pcomp = c(1:2), 
                             groups = "Family", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_tot_coda_rob_PC13_fam_ell, 
             biplot_pca_coda(PCA_fish_tot_coda_rob, 
                             fish_sp_means_tot, 
                             "fish_tot_coda_rob_PC13_fam_ell",
                             pcomp = c(1, 3), 
                             groups = "Family", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_tot_coda_rob_hab_ell, 
             biplot_pca_coda(PCA_fish_tot_coda_rob, 
                             fish_sp_means_tot, 
                             "fish_tot_coda_rob_PC12_hab_ell",
                             pcomp = c(1:2), 
                             groups = "habitat", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_tot_coda_rob_PC13_hab_ell, 
             biplot_pca_coda(PCA_fish_tot_coda_rob, 
                             fish_sp_means_tot, 
                             "fish_tot_coda_rob_PC13_hab_ell",
                             pcomp = c(1, 3), 
                             groups = "habitat", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  # classical (non-robust) coda PCA analysis
  tar_target(PCA_fish_tot_coda_norob, pca_coda_norob(fish_sp_means_tot, 
                                                     "fish")),
  tar_target(biplot_PCA_fish_tot_coda_norob_fam, 
             biplot_pca_coda(PCA_fish_tot_coda_norob, 
                             fish_sp_means_tot, 
                             "fish_tot_coda_norob_fam_PC12",
                             pcomp = c(1:2), 
                             groups = "Family", 
                             var.add.scaling = 2.5, 
                             ellipse = FALSE)),
  tar_target(biplot_PCA_fish_tot_coda_norob_fam_ell, 
             biplot_pca_coda(PCA_fish_tot_coda_norob, 
                             fish_sp_means_tot, 
                             "fish_tot_coda_norob_PC12_fam_ell",
                             pcomp = c(1:2), 
                             groups = "Family", 
                             var.add.scaling = 2.5, 
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_tot_coda_norob_PC13_fam_ell, 
             biplot_pca_coda(PCA_fish_tot_coda_norob, 
                             fish_sp_means_tot, 
                             "fish_tot_coda_norob_PC13_fam_ell",
                             pcomp = c(1,3), 
                             groups = "Family", 
                             var.add.scaling = 2.5, 
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_tot_coda_norob_hab_ell, 
             biplot_pca_coda(PCA_fish_tot_coda_norob, 
                             fish_sp_means_tot, 
                             "fish_tot_coda_norob_PC12_hab_ell",
                             pcomp = c(1:2), 
                             groups = "habitat", 
                             var.add.scaling = 2.5, 
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_tot_coda_norob_PC13_hab_ell, 
             biplot_pca_coda(PCA_fish_tot_coda_norob, 
                             fish_sp_means_tot, 
                             "fish_tot_coda_norob_PC13_hab_ell",
                             pcomp = c(1,3), 
                             groups = "habitat", 
                             var.add.scaling = 2.5, 
                             ellipse = TRUE)),
  # classical PCA analysis
  tar_target(PCA_fish_tot_nocoda, pca_nocoda(fish_sp_means_tot, 
                                             "fish")),
  tar_target(biplot_PCA_fish_tot_nocoda_PC12_fam, 
             biplot_pca_nocoda(PCA_fish_tot_nocoda, 
                               fish_sp_means_tot, 
                               groups = "Family", 
                               pcomp = c(1, 2),
                               "fish_tot_PC12_fam")),
  tar_target(biplot_PCA_fish_tot_nocoda_PC13_fam, 
             biplot_pca_nocoda(PCA_fish_tot_nocoda, 
                               fish_sp_means_tot, 
                               groups = "Family", 
                               pcomp = c(1, 3),
                               "fish_tot_PC13_fam")),
  tar_target(biplot_PCA_fish_tot_nocoda_PC12_hab, 
             biplot_pca_nocoda(PCA_fish_tot_nocoda, 
                               fish_sp_means_tot, 
                               groups = "habitat", 
                               pcomp = c(1, 2),
                               "fish_tot_PC12_hab")),
  tar_target(biplot_PCA_fish_tot_nocoda_PC13_hab, 
             biplot_pca_nocoda(PCA_fish_tot_nocoda, 
                               fish_sp_means_tot, 
                               groups = "habitat", 
                               pcomp = c(1, 3),
                               "fish_tot_PC13_hab")),
  
  # without what could be statistical outliers & robust CoDa PCA
  tar_target(PCA_fish_clean_coda_rob, pca_coda(fish_sp_means_clean, 
                                               "fish")),
  tar_target(PCA_fish_clean_coda_rob_nut_loadings_PCs, pca_coda_loadings_nut(PCA_fish_clean_coda_rob, 
                                                                             "fish",
                                                                             "fish_clean_coda_rob"
  )),
  tar_target(biplot_PCA_fish_clean_coda_rob_fam, 
             biplot_pca_coda(PCA_fish_clean_coda_rob, 
                             fish_sp_means_clean,
                             "fish_clean_coda_rob_PC12_fam",
                             pcomp = c(1:2), 
                             groups = "Family", 
                             var.add.scaling = 2.5,
                             ellipse = FALSE)),
  tar_target(biplot_PCA_fish_clean_coda_rob_fam_ell, 
             biplot_pca_coda(PCA_fish_clean_coda_rob, 
                             fish_sp_means_clean,
                             "fish_clean_coda_rob_PC12_fam_ell",
                             pcomp = c(1:2), 
                             groups = "Family", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_clean_coda_rob_PC13_fam_ell, 
             biplot_pca_coda(PCA_fish_clean_coda_rob, 
                             fish_sp_means_clean,
                             "fish_clean_coda_rob_PC13_fam_ell",
                             pcomp = c(1, 3), 
                             groups = "Family", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_clean_coda_rob_hab_ell, 
             biplot_pca_coda(PCA_fish_clean_coda_rob, 
                             fish_sp_means_clean,
                             "fish_clean_coda_rob_PC12_hab_ell",
                             pcomp = c(1:2), 
                             groups = "habitat", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_clean_coda_rob_PC13_hab_ell, 
             biplot_pca_coda(PCA_fish_clean_coda_rob, 
                             fish_sp_means_clean,
                             "fish_clean_coda_rob_PC13_hab_ell",
                             pcomp = c(1, 3), 
                             groups = "habitat", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  # without what could be statistical outliers but classical coda PCA analysis
  tar_target(PCA_fish_clean_coda_norob, pca_coda_norob(fish_sp_means_clean, 
                                                       "fish")),
  tar_target(biplot_PCA_fish_clean_coda_norob_fam, 
             biplot_pca_coda(PCA_fish_clean_coda_norob, 
                             fish_sp_means_clean,
                             "fish_clean_coda_norob_PC12_fam", 
                             pcomp = c(1:2), 
                             groups = "Family", 
                             var.add.scaling = 2.5,
                             ellipse = FALSE)),
  tar_target(biplot_PCA_fish_clean_coda_norob_fam_ell, 
             biplot_pca_coda(PCA_fish_clean_coda_norob, 
                             fish_sp_means_clean,
                             "fish_clean_coda_norob_PC12_fam_ell", 
                             pcomp = c(1:2), 
                             groups = "Family", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_clean_coda_norob_PC13_fam_ell, 
             biplot_pca_coda(PCA_fish_clean_coda_norob, 
                             fish_sp_means_clean,
                             "fish_clean_coda_norob_PC13_fam_ell", 
                             pcomp = c(1, 3), 
                             groups = "Family", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_clean_coda_norob_hab_ell, 
             biplot_pca_coda(PCA_fish_clean_coda_norob, 
                             fish_sp_means_clean,
                             "fish_clean_coda_norob_PC12_hab_ell", 
                             pcomp = c(1:2), 
                             groups = "habitat", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_clean_coda_norob_PC13_hab_ell, 
             biplot_pca_coda(PCA_fish_clean_coda_norob, 
                             fish_sp_means_clean,
                             "fish_clean_coda_norob_PC13_hab_ell", 
                             pcomp = c(1, 3), 
                             groups = "habitat", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  # without what could be statistical outliers but classical PCA
  tar_target(PCA_fish_clean_nocoda, pca_nocoda(fish_sp_means_clean, 
                                               "fish")),
  tar_target(biplot_PCA_fish_clean_nocoda_fam, 
             biplot_pca_nocoda(PCA_fish_clean_nocoda, 
                               fish_sp_means_clean, 
                               groups = "Family", 
                               pcomp = c(1, 2),
                               "fish_clean_PC12_fam")),
  tar_target(biplot_PCA_fish_clean_nocoda_PC13_fam, 
             biplot_pca_nocoda(PCA_fish_clean_nocoda, 
                               fish_sp_means_clean, 
                               groups = "Family", 
                               pcomp = c(1, 3),
                               "fish_clean_PC13_fam")),
  tar_target(biplot_PCA_fish_clean_nocoda_hab, 
             biplot_pca_nocoda(PCA_fish_clean_nocoda, 
                               fish_sp_means_clean, 
                               groups = "habitat", 
                               pcomp = c(1, 2),
                               "fish_clean_PC12_hab")),
  tar_target(biplot_PCA_fish_clean_nocoda_PC13_hab, 
             biplot_pca_nocoda(PCA_fish_clean_nocoda, 
                               fish_sp_means_clean, 
                               groups = "habitat", 
                               pcomp = c(1, 3),
                               "fish_clean_PC13_hab")),
  
  
  #---------------- SCATS -------------------------------
  # with all samples and robust CoDa PCA analysis 
  tar_target(PCA_scats_tot_coda_rob, pca_coda(full_res_compo_scats, 
                                              "scats")),
  tar_target(biplot_PCA_scats_tot_coda_rob, 
             biplot_pca_coda(PCA_scats_tot_coda_rob, 
                             full_res_compo_scats, 
                             "scats_tot_coda_rob_PC12_site",
                             pcomp = c(1:2), 
                             groups = "site", 
                             var.add.scaling = 2.5,
                             ellipse = FALSE)),
  tar_target(biplot_PCA_scats_tot_coda_rob_ell, 
             biplot_pca_coda(PCA_scats_tot_coda_rob, 
                             full_res_compo_scats, 
                             "scats_tot_coda_rob_PC12_ell_site",
                             pcomp = c(1:2), 
                             groups = "site", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_scats_tot_coda_rob_ell_HPI, 
             biplot_pca_coda(PCA_scats_tot_coda_rob, 
                             full_res_compo_scats, 
                             "scats_tot_coda_rob_PC12_ell_HPI",
                             pcomp = c(1:2), 
                             groups = "HPI", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_scats_tot_coda_rob_ell_PC13, 
             biplot_pca_coda(PCA_scats_tot_coda_rob, 
                             full_res_compo_scats, 
                             "scats_tot_coda_rob_PC13_ell_site",
                             pcomp = c(1, 3), 
                             groups = "site", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_scats_tot_coda_rob_ell_HPI_PC13, 
             biplot_pca_coda(PCA_scats_tot_coda_rob, 
                             full_res_compo_scats, 
                             "scats_tot_coda_rob_PC13_ell_HPI",
                             pcomp = c(1, 3), 
                             groups = "HPI", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  # with all samples and non-robust CoDa PCA analysis 
  tar_target(PCA_scats_tot_coda_norob, pca_coda_norob(full_res_compo_scats, 
                                                      "scats")),
  tar_target(biplot_PCA_scats_tot_coda_norob, 
             biplot_pca_coda(PCA_scats_tot_coda_norob, 
                             full_res_compo_scats, 
                             "scats_tot_coda_norob_PC12_site",
                             pcomp = c(1:2), 
                             groups = "site", 
                             var.add.scaling = 2.5,
                             ellipse = FALSE)), 
  tar_target(biplot_PCA_scats_tot_coda_norob_ell, 
             biplot_pca_coda(PCA_scats_tot_coda_norob, 
                             full_res_compo_scats, 
                             "scats_tot_coda_norob_PC12_ell_site",
                             pcomp = c(1:2), 
                             groups = "site", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)), 
  tar_target(biplot_PCA_scats_tot_coda_norob_HPI, 
             biplot_pca_coda(PCA_scats_tot_coda_norob, 
                             full_res_compo_scats, 
                             "scats_tot_coda_norob_PC12_ell_HPI",
                             pcomp = c(1:2), 
                             groups = "HPI", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_scats_tot_coda_norob_PC13, 
             biplot_pca_coda(PCA_scats_tot_coda_norob, 
                             full_res_compo_scats, 
                             "scats_tot_coda_norob_PC13_ell_site",
                             pcomp = c(1, 3), 
                             groups = "site", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)), 
  tar_target(biplot_PCA_scats_tot_coda_norob_HPI_PC13, 
             biplot_pca_coda(PCA_scats_tot_coda_norob, 
                             full_res_compo_scats, 
                             "scats_tot_coda_norob_PC13_ell_HPI",
                             pcomp = c(1, 3), 
                             groups = "HPI", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  # with all samples but classical PCA analysis
  tar_target(PCA_scats_tot_nocoda, pca_nocoda(full_res_compo_scats, 
                                              "scats")),
  tar_target(biplot_PCA_scats_tot_nocoda, 
             biplot_pca_nocoda(PCA_scats_tot_nocoda, 
                               full_res_compo_scats, 
                               groups = "site", 
                               pcomp = c(1, 2),
                               "scats_tot_PC12_site")),
  tar_target(biplot_PCA_scats_tot_nocoda_HPI, 
             biplot_pca_nocoda(PCA_scats_tot_nocoda, 
                               full_res_compo_scats, 
                               groups = "HPI", 
                               pcomp = c(1, 2),
                               "scats_tot_PC12_HPI")),
  tar_target(biplot_PCA_scats_tot_nocoda_PC13, 
             biplot_pca_nocoda(PCA_scats_tot_nocoda, 
                               full_res_compo_scats, 
                               groups = "site", 
                               pcomp = c(1, 3),
                               "scats_tot_PC13_site")),
  tar_target(biplot_PCA_scats_tot_nocoda_HPI_PC13, 
             biplot_pca_nocoda(PCA_scats_tot_nocoda, 
                               full_res_compo_scats, 
                               groups = "HPI", 
                               pcomp = c(1, 3),
                               "scats_tot_PC13_HPI")),
  
  
  ########## scats without scats suspected to be pups'
  # robust CoDa PCA analysis 
  tar_target(PCA_scats_nopup_coda_rob, pca_coda(full_res_compo_scats_nopup, 
                                                "scats")),
  tar_target(PCA_scats_nopup_coda_rob_nut_loadings_PCs, pca_coda_loadings_nut(PCA_scats_nopup_coda_rob, 
                                                                              "scats",
                                                                              "scats_nopup_coda_rob")),
  tar_target(biplot_PCA_scats_nopup_coda_rob, 
             biplot_pca_coda(PCA_scats_nopup_coda_rob, 
                             full_res_compo_scats_nopup, 
                             "scats_nopup_coda_rob_PC12_site",
                             pcomp = c(1:2), 
                             groups = "site", 
                             var.add.scaling = 2.5,
                             ellipse = FALSE)),
  tar_target(biplot_PCA_scats_nopup_coda_rob_ell, 
             biplot_pca_coda(PCA_scats_nopup_coda_rob, 
                             full_res_compo_scats_nopup, 
                             "scats_nopup_coda_rob_PC12_ell",
                             pcomp = c(1:2), 
                             groups = "site", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_scats_nopup_coda_rob_ell_HPI, 
             biplot_pca_coda(PCA_scats_nopup_coda_rob, 
                             full_res_compo_scats_nopup, 
                             "scats_nopup_coda_rob_PC12_ell_HPI",
                             pcomp = c(1:2), 
                             groups = "HPI", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_scats_nopup_coda_rob_ell_PC13, 
             biplot_pca_coda(PCA_scats_nopup_coda_rob, 
                             full_res_compo_scats_nopup, 
                             "scats_nopup_coda_rob_ell",
                             pcomp = c(1, 3), 
                             groups = "site", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_scats_nopup_coda_rob_ell_HPI_PC13, 
             biplot_pca_coda(PCA_scats_nopup_coda_rob, 
                             full_res_compo_scats_nopup, 
                             "scats_nopup_coda_rob_PC13_ell_HPI",
                             pcomp = c(1, 3), 
                             groups = "HPI", 
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  # non-robust CoDa PCA analysis 
  tar_target(PCA_scats_nopup_coda_norob, pca_coda_norob(full_res_compo_scats_nopup, 
                                                        "scats")),
  tar_target(biplot_PCA_scats_nopup_coda_norob, 
             biplot_pca_coda(PCA_scats_nopup_coda_norob, 
                             full_res_compo_scats_nopup, 
                             "scats_nopup_coda_norob_PC12_site",
                             pcomp = c(1:2), 
                             groups = "site", 
                             var.add.scaling = 2.5,
                             ellipse = FALSE)), 
  tar_target(biplot_PCA_scats_nopup_coda_norob_HPI, 
             biplot_pca_coda(PCA_scats_nopup_coda_norob, 
                             full_res_compo_scats_nopup, 
                             "scats_nopup_coda_norob_PC12_HPI",
                             pcomp = c(1:2), 
                             groups = "HPI", 
                             var.add.scaling = 2.5,
                             ellipse = FALSE)),
  tar_target(biplot_PCA_scats_nopup_coda_norob_PC13, 
             biplot_pca_coda(PCA_scats_nopup_coda_norob, 
                             full_res_compo_scats_nopup, 
                             "scats_nopup_coda_norob_PC13_site",
                             pcomp = c(1, 3), 
                             groups = "site", 
                             var.add.scaling = 2.5,
                             ellipse = FALSE)), 
  tar_target(biplot_PCA_scats_nopup_coda_norob_HPI_PC13, 
             biplot_pca_coda(PCA_scats_nopup_coda_norob, 
                             full_res_compo_scats_nopup, 
                             "scats_nopup_coda_norob_PC13_HPI",
                             pcomp = c(1, 3), 
                             groups = "HPI", 
                             var.add.scaling = 2.5,
                             ellipse = FALSE)),
  # classical PCA analysis
  tar_target(PCA_scats_nopup_nocoda, pca_nocoda(full_res_compo_scats_nopup, 
                                                "scats")),
  tar_target(biplot_PCA_scats_nopup_nocoda, 
             biplot_pca_nocoda(PCA_scats_nopup_nocoda, 
                               full_res_compo_scats_nopup, 
                               groups = "site", 
                               pcomp = c(1:2), 
                               "scats_nopup_PC12_site")),
  tar_target(biplot_PCA_scats_nopup_nocoda_HPI, 
             biplot_pca_nocoda(PCA_scats_nopup_nocoda, 
                               full_res_compo_scats_nopup, 
                               groups = "HPI", 
                               pcomp = c(1:2), 
                               "scats_nopup_PC12_HPI")),
  tar_target(biplot_PCA_scats_nopup_nocoda_PC13, 
             biplot_pca_nocoda(PCA_scats_nopup_nocoda, 
                               full_res_compo_scats_nopup, 
                               groups = "site", 
                               pcomp = c(1, 3), 
                               "scats_nopup_PC13_site")),
  tar_target(biplot_PCA_scats_nopup_nocoda_HPI_PC13, 
             biplot_pca_nocoda(PCA_scats_nopup_nocoda, 
                               full_res_compo_scats_nopup, 
                               groups = "HPI", 
                               pcomp = c(1, 3), 
                               "scats_nopup_PC13_HPI")),
  
  
  # ------------------- BOTH FISH AND SCATS -------------------
  ######  with all samples for fish and scats 
  # robust CoDa PCA analysis
  tar_target(PCA_fish_scats_tot_coda_rob, pca_coda(fish_sp_means_and_scats,
                                                   "both")),
  tar_target(biplot_PCA_fish_scats_tot_coda_rob,
             biplot_pca_coda(PCA_fish_scats_tot_coda_rob,
                             fish_sp_means_and_scats,
                             "fish_scats_tot_coda_rob_PC12",
                             pcomp = c(1:2),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = FALSE)),
  tar_target(biplot_PCA_fish_scats_tot_coda_rob_ell,
             biplot_pca_coda(PCA_fish_scats_tot_coda_rob,
                             fish_sp_means_and_scats,
                             "fish_scats_tot_coda_rob_PC12_ell",
                             pcomp = c(1:2),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_scats_tot_coda_rob_PC13_ell,
             biplot_pca_coda(PCA_fish_scats_tot_coda_rob,
                             fish_sp_means_and_scats,
                             "fish_scats_tot_coda_rob_PC13_ell",
                             pcomp = c(1, 3),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  # non-robust CoDa PCA analysis
  tar_target(PCA_fish_scats_tot_coda_norob, pca_coda_norob(fish_sp_means_and_scats,
                                                           "both")),
  tar_target(biplot_PCA_fish_scats_tot_coda_norob,
             biplot_pca_coda(PCA_fish_scats_tot_coda_norob,
                             fish_sp_means_and_scats,
                             "fish_scats_tot_coda_norob_PC12",
                             pcomp = c(1:2),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = FALSE)),
  tar_target(biplot_PCA_fish_scats_tot_coda_norob_ell,
             biplot_pca_coda(PCA_fish_scats_tot_coda_norob,
                             fish_sp_means_and_scats,
                             "fish_scats_tot_coda_norob_PC12_ell",
                             pcomp = c(1:2),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_scats_tot_coda_norob_PC13_ell,
             biplot_pca_coda(PCA_fish_scats_tot_coda_norob,
                             fish_sp_means_and_scats,
                             "fish_scats_tot_coda_norob_PC13_ell",
                             pcomp = c(1, 3),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  # classical PCA analysis
  tar_target(PCA_fish_scats_tot_nocoda, pca_nocoda(fish_sp_means_and_scats,
                                                   "both")),
  tar_target(biplot_PCA_fish_scats_tot_nocoda,
             biplot_pca_nocoda(PCA_fish_scats_tot_nocoda,
                               fish_sp_means_and_scats,
                               groups = "type",
                               pcomp = c(1:2),
                               "fish_scats_tot_PC12")),
  tar_target(biplot_PCA_fish_scats_tot_nocoda_PC13,
             biplot_pca_nocoda(PCA_fish_scats_tot_nocoda,
                               fish_sp_means_and_scats,
                               groups = "type",
                               pcomp = c(1, 3),
                               "fish_scats_tot_PC13")), 
  
  ####### with stat.outliers handled for fish and all samples for scats 
  # robust CoDa PCA analysis
  tar_target(PCA_fish_clean_scats_coda_rob,
             pca_coda(fish_sp_means_clean_and_scats,
                      "both")),
  tar_target(biplot_PCA_fish_clean_scats_coda_rob,
             biplot_pca_coda(PCA_fish_clean_scats_coda_rob,
                             fish_sp_means_clean_and_scats,
                             "fish_clean_scats_coda_rob_PC12",
                             pcomp = c(1:2),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = FALSE)),
  tar_target(biplot_PCA_fish_clean_scats_coda_rob_ell,
             biplot_pca_coda(PCA_fish_clean_scats_coda_rob,
                             fish_sp_means_clean_and_scats,
                             "fish_clean_scats_coda_rob_PC12_ell",
                             pcomp = c(1:2),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_clean_scats_coda_rob_PC13_ell,
             biplot_pca_coda(PCA_fish_clean_scats_coda_rob,
                             fish_sp_means_clean_and_scats,
                             "fish_clean_scats_coda_rob_PC13_ell",
                             pcomp = c(1, 3),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  # non-robust CoDa PCA analysis
  tar_target(PCA_fish_clean_scats_coda_norob, 
             pca_coda_norob(fish_sp_means_clean_and_scats,
                            "both")),
  tar_target(biplot_PCA_fish_clean_scats_coda_norob,
             biplot_pca_coda(PCA_fish_clean_scats_coda_norob,
                             fish_sp_means_clean_and_scats,
                             "fish_clean_scats_coda_norob_PC12",
                             pcomp = c(1:2),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = FALSE)),
  tar_target(biplot_PCA_fish_clean_scats_coda_norob_ell,
             biplot_pca_coda(PCA_fish_clean_scats_coda_norob,
                             fish_sp_means_clean_and_scats,
                             "fish_clean_scats_coda_norob_PC12_ell",
                             pcomp = c(1:2),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_clean_scats_coda_norob_PC13_ell,
             biplot_pca_coda(PCA_fish_clean_scats_coda_norob,
                             fish_sp_means_clean_and_scats,
                             "fish_clean_scats_coda_norob_PC13_ell",
                             pcomp = c(1, 3),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  # classical PCA analysis
  tar_target(PCA_fish_clean_scats_nocoda, 
             pca_nocoda(fish_sp_means_clean_and_scats,
                        "both")),
  tar_target(biplot_PCA_fish_clean_scats_nocoda,
             biplot_pca_nocoda(PCA_fish_clean_scats_nocoda,
                               fish_sp_means_clean_and_scats,
                               groups = "type",
                               pcomp = c(1:2),
                               "fish_clean_scats_PC12")),
  tar_target(biplot_PCA_fish_clean_scats_nocoda_PC13,
             biplot_pca_nocoda(PCA_fish_clean_scats_nocoda,
                               fish_sp_means_clean_and_scats,
                               groups = "type",
                               pcomp = c(1, 3),
                               "fish_clean_scats_PC13")),
  
  
  ####### with stat.outliers handle for fish and scats with no pup suspicion 
  # robust CoDa PCA analysis
  tar_target(PCA_fish_clean_scats_nopup_coda_rob, 
             pca_coda(fish_sp_means_clean_and_scats_nopup,
                      "both")),
  ### CAREFUL the following function should only be used with outputs of 
  # PCA_fish_clean_scats_nopup_coda_rob, PCA_fish_clean_coda_rob and 
  # PCA_scats_nopup_coda_rob
  # because prop of variance of Principal components are entered by hand in the 
  # function, so they would not be valid for other PCA outputs
  tar_target(PCA_fish_clean_scats_nopup_coda_rob_nut_loadings_PCs, 
             pca_coda_loadings_nut(PCA_fish_clean_scats_nopup_coda_rob, 
                                   "both",
                                   "fish_clean_scats_nopup_coda_rob")),
  tar_target(biplot_PCA_fish_clean_scats_nopup_coda_rob,
             biplot_pca_coda(PCA_fish_clean_scats_nopup_coda_rob,
                             fish_sp_means_clean_and_scats_nopup,
                             "fish_clean_scats_nopup_coda_rob_PC12",
                             pcomp = c(1:2),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = FALSE)),
  tar_target(biplot_PCA_fish_clean_scats_nopup_coda_rob_ell,
             biplot_pca_coda(PCA_fish_clean_scats_nopup_coda_rob,
                             fish_sp_means_clean_and_scats_nopup,
                             "fish_clean_scats_nopup_coda_rob_PC12_ell",
                             pcomp = c(1:2),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_clean_scats_nopup_coda_rob_PC13_ell,
             biplot_pca_coda(PCA_fish_clean_scats_nopup_coda_rob,
                             fish_sp_means_clean_and_scats_nopup,
                             "fish_clean_scats_nopup_coda_rob_PC13_ell",
                             pcomp = c(1, 3),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  # non-robust CoDa PCA analysis
  tar_target(PCA_fish_clean_scats_nopup_coda_norob, 
             pca_coda_norob(fish_sp_means_clean_and_scats_nopup,
                            "both")),
  tar_target(biplot_PCA_fish_clean_scats_nopup_coda_norob,
             biplot_pca_coda(PCA_fish_clean_scats_nopup_coda_norob,
                             fish_sp_means_clean_and_scats_nopup,
                             "fish_clean_scats_nopup_coda_norob_PC12",
                             pcomp = c(1:2),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = FALSE)),
  tar_target(biplot_PCA_fish_clean_scats_nopup_coda_norob_ell,
             biplot_pca_coda(PCA_fish_clean_scats_nopup_coda_norob,
                             fish_sp_means_clean_and_scats_nopup,
                             "fish_clean_scats_nopup_coda_norob_PC12_ell",
                             pcomp = c(1:2),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  tar_target(biplot_PCA_fish_clean_scats_nopup_coda_norob_PC13_ell,
             biplot_pca_coda(PCA_fish_clean_scats_nopup_coda_norob,
                             fish_sp_means_clean_and_scats_nopup,
                             "fish_clean_scats_nopup_coda_norob_PC13_ell",
                             pcomp = c(1, 3),
                             groups = "type",
                             var.add.scaling = 2.5,
                             ellipse = TRUE)),
  # classical PCA analysis
  tar_target(PCA_fish_clean_scats_nopup_nocoda, 
             pca_nocoda(fish_sp_means_clean_and_scats_nopup,
                        "both")),
  tar_target(biplot_PCA_fish_clean_scats_nopup_nocoda,
             biplot_pca_nocoda(PCA_fish_clean_scats_nopup_nocoda,
                               fish_sp_means_clean_and_scats_nopup,
                               groups = "type",
                               pcomp = c(1:2),
                               "fish_clean_scats_nopup_PC12")),
  tar_target(biplot_PCA_fish_clean_scats_nopup_nocoda_PC13,
             biplot_pca_nocoda(PCA_fish_clean_scats_nopup_nocoda,
                               fish_sp_means_clean_and_scats_nopup,
                               groups = "type",
                               pcomp = c(1, 3),
                               "fish_clean_scats_nopup_PC13")),
  
  
  ##################### CLUSTERING #############################################
  
  # ------------- FISH ---------------------
  # without handling of stat. outliers
  # using PCs of PCA computed with mean per species
  # dendrogram
  tar_target(clust_fish_tot_PCs_dendro_fam, 
             clust_compo_PCs_dendro_fish(PCA_fish_tot_coda_rob,
                                         fish_sp_means_tot,
                                         fish_sp_means_and_scats,
                                         method = "ward.D2", 
                                         k = 3, # not useful here to colour by Family
                                         colour = "Family", 
                                         file_name = "tot_PCs")),
  tar_target(clust_fish_tot_PCs_dendro_hab, 
             clust_compo_PCs_dendro_fish(PCA_fish_tot_coda_rob,
                                         fish_sp_means_tot,
                                         fish_sp_means_and_scats,
                                         method = "ward.D2", 
                                         k = 4, # not useful here to colour by habitat
                                         colour = "habitat", 
                                         file_name = "tot_PCs")),
  # hclust algorithm
  tar_target(findk_ward_fish_output, 
             clust_find_k_table_PCs(PCA_fish_tot_coda_rob,
                                    type = "fish",
                                    k = c(2:10),
                                    method = "ward.D2",
                                    object_type = "output", 
                                    file_name = "tot_PCs")),
  tar_target(findk_ward_fish_file, 
             clust_find_k_table_PCs(PCA_fish_tot_coda_rob,
                                    type = "fish",
                                    k = c(2:10),
                                    method = "ward.D2",
                                    object_type = "file", 
                                    file_name = "tot_PCs")),
  tar_target(findk_ward_boxplot_fish, 
             boxplot_clust_find_k_val(findk_ward_fish_output,
                                      "fish", 
                                      file_name = "tot_PCs")),
  tar_target(findk_ward_means_fish, 
             means_clust_find_k_val(findk_ward_fish_output,
                                    "fish", 
                                    file_name = "tot_PCs")),
  # k = 4
  tar_target(clust_fish_tot_PCs_k4_ward_file, 
             clust_compo_PCs(PCA_fish_tot_coda_rob,
                             type = "fish",
                             k = 4,
                             method = "ward.D2",
                             "file",
                             "fish_tot_coda_rob_k4_ward")),
  tar_target(clust_fish_tot_PCs_k4_ward_output, 
             clust_compo_PCs(PCA_fish_tot_coda_rob,
                             type = "fish",
                             k = 4,
                             method = "ward.D2",
                             "output",
                             "fish_tot_coda_rob_k4_ward")),
  tar_target(clust_fish_tot_PCs_k4_dendro, 
             clust_compo_PCs_dendro_fish(PCA_fish_tot_coda_rob,
                                         fish_sp_means_tot,
                                         fish_sp_means_and_scats,
                                         method = "ward.D2", 
                                         k = 4, 
                                         colour = "Cluster", 
                                         file_name = "fish_tot_PCs")),
  tar_target(boxplot_clust_fish_tot_PCs_k4_ward, 
             boxplot_compo_clust(clust_fish_tot_PCs_k4_ward_output,
                                 fish_sp_means_tot,
                                 "fish_tot_PCs_k4_ward")),
  tar_target(barplot_clust_fish_tot_PCs_k4_ward, 
             barplot_clust(clust_fish_tot_PCs_k4_ward_output,
                           fish_sp_means_tot,
                           "fish_tot_PCs_k4_ward")),
  tar_target(biplot_clust_PCs_tot_k4_fish,
             biplot_after_clust(PCA_fish_tot_coda_rob,
                                clust_fish_tot_PCs_k4_ward_output,
                                fish_sp_means_tot,
                                "fish",
                                "PCs_tot_k4_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  # k = 2
  tar_target(clust_fish_tot_PCs_k2_ward_file, 
             clust_compo_PCs(PCA_fish_tot_coda_rob,
                             "fish",
                             k = 2,
                             method = "ward.D2",
                             "file",
                             "fish_tot_coda_rob_k2_ward")),
  tar_target(clust_fish_tot_PCs_k2_ward_output, 
             clust_compo_PCs(PCA_fish_tot_coda_rob,
                             "fish",
                             k = 2,
                             method = "ward.D2",
                             "output",
                             "fish_tot_coda_rob_k2_ward")),
  tar_target(clust_fish_tot_PCs_k2_dendro, 
             clust_compo_PCs_dendro_fish(PCA_fish_tot_coda_rob,
                                         fish_sp_means_tot,
                                         fish_sp_means_and_scats,
                                         method = "ward.D2", 
                                         k = 2, 
                                         colour = "Cluster", 
                                         file_name = "fish_tot_PCs")),
  tar_target(boxplot_clust_fish_tot_PCs_k2_ward, 
             boxplot_compo_clust(clust_fish_tot_PCs_k2_ward_output,
                                 fish_sp_means_tot,
                                 "fish_tot_PCs_k2_ward")),
  tar_target(barplot_clust_fish_tot_PCs_k2_ward, 
             barplot_clust(clust_fish_tot_PCs_k2_ward_output,
                           fish_sp_means_tot,
                           "fish_tot_PCs_k2_ward")),
  tar_target(biplot_clust_fish_tot_PCs_k2,
             biplot_after_clust(PCA_fish_tot_coda_rob,
                                clust_fish_tot_PCs_k2_ward_output,
                                fish_sp_means_tot,
                                "fish",
                                "PCs_tot_coda_rob_k2_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  
  # k = 3
  tar_target(clust_fish_tot_PCs_k3_ward_file, 
             clust_compo_PCs(PCA_fish_tot_coda_rob,
                             "fish",
                             k = 3,
                             method = "ward.D2",
                             "file",
                             "fish_tot_coda_rob_k3_ward")),
  tar_target(clust_fish_tot_PCs_k3_ward_output, 
             clust_compo_PCs(PCA_fish_tot_coda_rob,
                             "fish",
                             k = 3,
                             method = "ward.D2",
                             "output",
                             "fish_tot_coda_rob_k3_ward")),
  tar_target(clust_fish_tot_PCs_k3_dendro, 
             clust_compo_PCs_dendro_fish(PCA_fish_tot_coda_rob,
                                         fish_sp_means_tot,
                                         fish_sp_means_and_scats,
                                         method = "ward.D2", 
                                         k = 3, 
                                         colour = "Cluster", 
                                         file_name = "fish_tot_PCs")),
  tar_target(boxplot_clust_fish_tot_PCs_k3_ward, 
             boxplot_compo_clust(clust_fish_tot_PCs_k3_ward_output,
                                 fish_sp_means_tot,
                                 "fish_tot_PCs_k3_ward")),
  tar_target(barplot_clust_fish_tot_PCs_k3_ward, 
             barplot_clust(clust_fish_tot_PCs_k3_ward_output,
                           fish_sp_means_tot,
                           "fish_tot_PCs_k3_ward")),
  tar_target(biplot_clust_fish_tot_PCs_k3,
             biplot_after_clust(PCA_fish_tot_coda_rob,
                                clust_fish_tot_PCs_k3_ward_output,
                                fish_sp_means_tot,
                                "fish",
                                "PCs_tot_coda_rob_k3_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  # k = 5
  tar_target(clust_fish_tot_PCs_k5_ward_file, 
             clust_compo_PCs(PCA_fish_tot_coda_rob,
                             "fish",
                             k = 5,
                             method = "ward.D2",
                             "file",
                             "fish_tot_coda_rob_k5_ward")),
  tar_target(clust_fish_tot_PCs_k5_ward_output, 
             clust_compo_PCs(PCA_fish_tot_coda_rob,
                             "fish",
                             k = 5,
                             method = "ward.D2",
                             "output",
                             "fish_tot_coda_rob_k5_ward")),
  tar_target(clust_fish_tot_PCs_k5_dendro, 
             clust_compo_PCs_dendro_fish(PCA_fish_tot_coda_rob,
                                         fish_sp_means_tot,
                                         fish_sp_means_and_scats,
                                         method = "ward.D2", 
                                         k = 5, 
                                         colour = "Cluster", 
                                         file_name = "fish_tot_PCs")),
  tar_target(boxplot_clust_fish_tot_PCs_k5_ward, 
             boxplot_compo_clust(clust_fish_tot_PCs_k5_ward_output,
                                 fish_sp_means_tot,
                                 "fish_tot_PCs_k5_ward")),
  tar_target(barplot_clust_fish_tot_PCs_k5_ward, 
             barplot_clust(clust_fish_tot_PCs_k5_ward_output,
                           fish_sp_means_tot,
                           "fish_tot_PCs_k5_ward")),
  tar_target(biplot_clust_fish_tot_PCs_k5,
             biplot_after_clust(PCA_fish_tot_coda_rob,
                                clust_fish_tot_PCs_k5_ward_output,
                                fish_sp_means_tot,
                                "fish",
                                "PCs_tot_coda_rob_k5_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  # k = 6
  tar_target(clust_fish_tot_PCs_k6_ward_file, 
             clust_compo_PCs(PCA_fish_tot_coda_rob,
                             "fish",
                             k = 6,
                             method = "ward.D2",
                             "file",
                             "fish_tot_coda_rob_k6_ward")),
  tar_target(clust_fish_tot_PCs_k6_ward_output, 
             clust_compo_PCs(PCA_fish_tot_coda_rob,
                             "fish",
                             k = 6,
                             method = "ward.D2",
                             "output",
                             "fish_tot_coda_rob_k6_ward")),
  tar_target(clust_fish_tot_PCs_k6_dendro, 
             clust_compo_PCs_dendro_fish(PCA_fish_tot_coda_rob,
                                         fish_sp_means_tot,
                                         fish_sp_means_and_scats,
                                         method = "ward.D2", 
                                         k = 6, 
                                         colour = "Cluster", 
                                         file_name = "fish_tot_PCs")),
  tar_target(boxplot_clust_fish_tot_PCs_k6_ward, 
             boxplot_compo_clust(clust_fish_tot_PCs_k6_ward_output,
                                 fish_sp_means_tot,
                                 "fish_tot_PCs_k6_ward")),
  tar_target(barplot_clust_fish_tot_PCs_k6_ward, 
             barplot_clust(clust_fish_tot_PCs_k6_ward_output,
                           fish_sp_means_tot,
                           "fish_tot_PCs_k6_ward")),
  tar_target(biplot_clust_fish_tot_PCs_k6,
             biplot_after_clust(PCA_fish_tot_coda_rob,
                                clust_fish_tot_PCs_k6_ward_output,
                                fish_sp_means_tot,
                                "fish",
                                "PCs_tot_coda_rob_k6_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  
  
  # with handling of stat. outliers
  # using PCs of PCA computed with mean per species
  # dendrogram
  tar_target(clust_fish_clean_PCs_dendro_fam, 
             clust_compo_PCs_dendro_fish(PCA_fish_clean_coda_rob,
                                         fish_sp_means_clean,
                                         fish_sp_means_and_scats,
                                         method = "ward.D2", 
                                         k = 3, # not useful here to colour by Family
                                         colour = "Family", 
                                         file_name = "clean_PCs")),
  tar_target(clust_fish_clean_PCs_dendro_hab, 
             clust_compo_PCs_dendro_fish(PCA_fish_clean_coda_rob,
                                         fish_sp_means_clean,
                                         fish_sp_means_and_scats,
                                         method = "ward.D2", 
                                         k = 3, # not useful here to colour by habitat
                                         colour = "habitat", 
                                         file_name = "clean_PCs")),
  tar_target(clust_fish_clean_PCs_dendro_diet, 
             clust_compo_PCs_dendro_fish(PCA_fish_clean_coda_rob,
                                         fish_sp_means_clean,
                                         fish_sp_means_and_scats,
                                         method = "ward.D2", 
                                         k = 3, # not useful here to colour by habita
                                         colour = "diet", 
                                         file_name = "fish_clean_PCs")),
  # hclust algorithm
  tar_target(findk_ward_fish_clean_output, 
             clust_find_k_table_PCs(PCA_fish_clean_coda_rob,
                                    type = "fish",
                                    k = c(2:10),
                                    method = "ward.D2",
                                    object_type = "output", 
                                    file_name = "clean_PCs")),
  tar_target(findk_ward_fish_clean_file, 
             clust_find_k_table_PCs(PCA_fish_clean_coda_rob,
                                    type = "fish",
                                    k = c(2:10),
                                    method = "ward.D2",
                                    object_type = "file", 
                                    file_name = "clean_PCs")),
  tar_target(findk_ward_boxplot_fish_clean, 
             boxplot_clust_find_k_val(findk_ward_fish_clean_output,
                                      "fish", 
                                      file_name = "clean_PCs")),
  tar_target(findk_ward_means_fish_clean, 
             means_clust_find_k_val(findk_ward_fish_clean_output,
                                    "fish", 
                                    file_name = "clean_PCs")),
  # k = 2
  tar_target(clust_fish_clean_PCs_k2_ward_file, 
             clust_compo_PCs(PCA_fish_clean_coda_rob,
                             type = "fish",
                             k = 2,
                             method = "ward.D2",
                             "file",
                             "fish_clean_coda_rob_k2_ward")),
  tar_target(clust_fish_clean_PCs_k2_ward_output, 
             clust_compo_PCs(PCA_fish_clean_coda_rob,
                             type = "fish",
                             k = 2,
                             method = "ward.D2",
                             "output",
                             "fish_clean_coda_rob_k2_ward")),
  tar_target(clust_fish_clean_PCs_k2_dendro, 
             clust_compo_PCs_dendro_fish(PCA_fish_clean_coda_rob,
                                         fish_sp_means_clean,
                                         fish_sp_means_and_scats,
                                         method = "ward.D2", 
                                         k = 2, 
                                         colour = "Cluster", 
                                         file_name = "fish_clean_PCs")),
  tar_target(boxplot_clust_fish_clean_PCs_k2_ward, 
             boxplot_compo_clust(clust_fish_clean_PCs_k2_ward_output,
                                 fish_sp_means_clean,
                                 "fish_clean_PCs_k2_ward")),
  tar_target(barplot_clust_fish_clean_PCs_k2_ward, 
             barplot_clust(clust_fish_clean_PCs_k2_ward_output,
                           fish_sp_means_clean,
                           "fish_clean_PCs_k2_ward")),
  tar_target(biplot_clust_fish_clean_PCs_k2,
             biplot_after_clust(PCA_fish_clean_coda_rob,
                                clust_fish_clean_PCs_k2_ward_output,
                                fish_sp_means_clean,
                                "fish",
                                "clean_PCs_k2_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  tar_target(MWtest_clust_fish_clean_PCs_k2_ward, 
             MWtest_clust_k2(clust_fish_clean_PCs_k2_ward_output,
                             fish_sp_means_clean,
                             "fish_clean_PCs_k2_ward")),
  # k = 3
  tar_target(clust_fish_clean_PCs_k3_ward_file, 
             clust_compo_PCs(PCA_fish_clean_coda_rob,
                             type = "fish",
                             k = 3,
                             method = "ward.D2",
                             "file",
                             "fish_clean_coda_rob_k3_ward")),
  tar_target(clust_fish_clean_PCs_k3_ward_output, 
             clust_compo_PCs(PCA_fish_clean_coda_rob,
                             type = "fish",
                             k = 3,
                             method = "ward.D2",
                             "output",
                             "fish_clean_coda_rob_k3_ward")),
  tar_target(clust_fish_clean_PCs_k3_dendro, 
             clust_compo_PCs_dendro_fish(PCA_fish_clean_coda_rob,
                                         fish_sp_means_clean,
                                         fish_sp_means_and_scats,
                                         method = "ward.D2", 
                                         k = 3, 
                                         colour = "Cluster", 
                                         file_name = "fish_clean_PCs")),
  tar_target(boxplot_clust_fish_clean_PCs_k3_ward, 
             boxplot_compo_clust(clust_fish_clean_PCs_k3_ward_output,
                                 fish_sp_means_clean,
                                 "fish_clean_PCs_k3_ward")),
  tar_target(barplot_clust_fish_clean_PCs_k3_ward, 
             barplot_clust(clust_fish_clean_PCs_k3_ward_output,
                           fish_sp_means_clean,
                           "fish_clean_PCs_k3_ward")),
  tar_target(biplot_clust_fish_clean_PCs_k3,
             biplot_after_clust(PCA_fish_clean_coda_rob,
                                clust_fish_clean_PCs_k3_ward_output,
                                fish_sp_means_clean,
                                "fish",
                                "clean_PCs_k3_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  tar_target(MWtest_clust_fish_clean_PCs_k3_ward, 
             MWtest_clust_k3(clust_fish_clean_PCs_k3_ward_output,
                             fish_sp_means_clean,
                             "fish_clean_PCs_k3_ward")),
  # k = 4
  tar_target(clust_fish_clean_PCs_k4_ward_file, 
             clust_compo_PCs(PCA_fish_clean_coda_rob,
                             type = "fish",
                             k = 4,
                             method = "ward.D2",
                             "file",
                             "fish_clean_coda_rob_k4_ward")),
  tar_target(clust_fish_clean_PCs_k4_ward_output, 
             clust_compo_PCs(PCA_fish_clean_coda_rob,
                             type = "fish",
                             k = 4,
                             method = "ward.D2",
                             "output",
                             "fish_clean_coda_rob_k4_ward")),
  tar_target(clust_fish_clean_PCs_k4_dendro, 
             clust_compo_PCs_dendro_fish(PCA_fish_clean_coda_rob,
                                         fish_sp_means_clean,
                                         fish_sp_means_and_scats,
                                         method = "ward.D2", 
                                         k = 4, 
                                         colour = "Cluster", 
                                         file_name = "fish_clean_PCs")),
  tar_target(clust_fish_clean_PCs_k4_stats, 
             stats_compo_clust(clust_fish_clean_PCs_k4_ward_output,
                               fish_sp_means_clean, 
                               file_name = "fish_clean_PCs_k4")),
  tar_target(clust_fish_clean_PCs_k4_samples_table, 
             clust_samples(clust_fish_clean_PCs_k4_ward_output,
                           fish_sp_means_clean, 
                           file_name = "fish_clean_PCs_k4")),
  tar_target(boxplot_clust_fish_clean_PCs_k4_ward, 
             boxplot_compo_clust(clust_fish_clean_PCs_k4_ward_output,
                                 fish_sp_means_clean,
                                 "fish_clean_PCs_k4_ward")),
  tar_target(barplot_clust_fish_clean_PCs_k4_ward, 
             barplot_clust(clust_fish_clean_PCs_k4_ward_output,
                           fish_sp_means_clean,
                           "fish_clean_PCs_k4_ward")),
  tar_target(biplot_clust_fish_clean_PCs_k4,
             biplot_after_clust(PCA_fish_clean_coda_rob,
                                clust_fish_clean_PCs_k4_ward_output,
                                fish_sp_means_clean,
                                "fish",
                                "clean_PCs_k4_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  tar_target(MWtest_clust_fish_clean_PCs_k4_ward, 
             MWtest_clust_k4(clust_fish_clean_PCs_k4_ward_output,
                             fish_sp_means_clean,
                             "fish_clean_PCs_k4_ward")),
  # k = 5
  tar_target(clust_fish_clean_PCs_k5_ward_file, 
             clust_compo_PCs(PCA_fish_clean_coda_rob,
                             type = "fish",
                             k = 5,
                             method = "ward.D2",
                             "file",
                             "fish_clean_coda_rob_k5_ward")),
  tar_target(clust_fish_clean_PCs_k5_ward_output, 
             clust_compo_PCs(PCA_fish_clean_coda_rob,
                             type = "fish",
                             k = 5,
                             method = "ward.D2",
                             "output",
                             "fish_clean_coda_rob_k5_ward")),
  tar_target(clust_fish_clean_PCs_k5_dendro, 
             clust_compo_PCs_dendro_fish(PCA_fish_clean_coda_rob,
                                         fish_sp_means_clean,
                                         fish_sp_means_and_scats,
                                         method = "ward.D2", 
                                         k = 5, 
                                         colour = "Cluster", 
                                         file_name = "fish_clean_PCs")),
  tar_target(boxplot_clust_fish_clean_PCs_k5_ward, 
             boxplot_compo_clust(clust_fish_clean_PCs_k5_ward_output,
                                 fish_sp_means_clean,
                                 "fish_clean_PCs_k5_ward")),
  tar_target(barplot_clust_fish_clean_PCs_k5_ward, 
             barplot_clust(clust_fish_clean_PCs_k5_ward_output,
                           fish_sp_means_clean,
                           "fish_clean_PCs_k5_ward")),
  tar_target(biplot_clust_fish_clean_PCs_k5,
             biplot_after_clust(PCA_fish_clean_coda_rob,
                                clust_fish_clean_PCs_k5_ward_output,
                                fish_sp_means_clean,
                                "fish",
                                "clean_PCs_k5_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  tar_target(MWtest_clust_fish_clean_PCs_k5_ward, 
             MWtest_clust_k5(clust_fish_clean_PCs_k5_ward_output,
                             fish_sp_means_clean,
                             "fish_clean_PCs_k5_ward")),
  
  # trying on real concentrations using algorithm for compositional dataset
  # and only a few nutrients identified as structuring with PCAs
  tar_target(findk_ward_fish_nutrients_output, 
             clust_find_k_table(fish_sp_means_clean,
                                type = "fish",
                                k = c(2:10),
                                nutrients = c("Fe", "As", 
                                              "Ni", "K", 
                                              "Se"),
                                method = "ward.D2",
                                object_type = "output")),
  # k = 2
  tar_target(clust_fish_clean_nutrients_k2_ward_output, 
             clust_compo_full_tib(fish_sp_means_clean,
                                  type = "fish",
                                  nutrients = c("Fe", "As", 
                                                "Ni", "K", 
                                                "Se"),
                                  k = 2,
                                  method = "ward.D2")),
  tar_target(biplot_clust_fish_clean_nutrients_k2,
             biplot_after_clust(PCA_fish_clean_coda_rob,
                                clust_fish_clean_nutrients_k2_ward_output,
                                fish_sp_means_clean,
                                "fish",
                                "clean_nutrients_k2_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  # k = 3
  tar_target(clust_fish_clean_nutrients_k3_ward_output, 
             clust_compo_full_tib(fish_sp_means_clean,
                                  type = "fish",
                                  nutrients = c("Fe", "As", 
                                                "Ni", "K", 
                                                "Se"),
                                  k = 3,
                                  method = "ward.D2")),
  tar_target(biplot_clust_fish_clean_nutrients_k3,
             biplot_after_clust(PCA_fish_clean_coda_rob,
                                clust_fish_clean_nutrients_k3_ward_output,
                                fish_sp_means_clean,
                                "fish",
                                "clean_nutrients_k3_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  tar_target(boxplot_clust_fish_clean_nutrients_k3_ward, 
             boxplot_compo_clust(clust_fish_clean_nutrients_k3_ward_output,
                                 fish_sp_means_clean,
                                 "fish_clean_nutrients_k3_ward")),
  tar_target(barplot_clust_fish_clean_nutrients_k3_ward, 
             barplot_clust(clust_fish_clean_nutrients_k3_ward_output,
                           fish_sp_means_clean,
                           "fish_clean_nutrients_k3_ward")),
  # k = 4
  tar_target(clust_fish_clean_nutrients_k4_ward_output, 
             clust_compo_full_tib(fish_sp_means_clean,
                                  type = "fish",
                                  nutrients = c("Fe", "As", 
                                                "Ni", "K", 
                                                "Se"),
                                  k = 4,
                                  method = "ward.D2")),
  tar_target(biplot_clust_fish_clean_nutrients_k4,
             biplot_after_clust(PCA_fish_clean_coda_rob,
                                clust_fish_clean_nutrients_k4_ward_output,
                                fish_sp_means_clean,
                                "fish",
                                "clean_nutrients_k4_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  tar_target(boxplot_clust_fish_clean_nutrients_k4_ward, 
             boxplot_compo_clust(clust_fish_clean_nutrients_k4_ward_output,
                                 fish_sp_means_clean,
                                 "fish_clean_nutrients_k4_ward")),
  tar_target(barplot_clust_fish_clean_nutrients_k4_ward, 
             barplot_clust(clust_fish_clean_nutrients_k4_ward_output,
                           fish_sp_means_clean,
                           "fish_clean_nutrients_k4_ward")),
  # k = 5
  tar_target(clust_fish_clean_nutrients_k5_ward_output, 
             clust_compo_full_tib(fish_sp_means_clean,
                                  type = "fish",
                                  nutrients = c("Fe", "As", 
                                                "Ni", "K", 
                                                "Se"),
                                  k = 5,
                                  method = "ward.D2")),
  tar_target(biplot_clust_fish_clean_nutrients_k5,
             biplot_after_clust(PCA_fish_clean_coda_rob,
                                clust_fish_clean_nutrients_k5_ward_output,
                                fish_sp_means_clean,
                                "fish",
                                "clean_nutrients_k5_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  tar_target(boxplot_clust_fish_clean_nutrients_k5_ward, 
             boxplot_compo_clust(clust_fish_clean_nutrients_k5_ward_output,
                                 fish_sp_means_clean,
                                 "fish_clean_nutrients_k5_ward")),
  tar_target(barplot_clust_fish_clean_nutrients_k5_ward, 
             barplot_clust(clust_fish_clean_nutrients_k5_ward_output,
                           fish_sp_means_clean,
                           "fish_clean_nutrients_k5_ward")),
  
  
  #------------------- SCATS ----------------------
  # without deleting that suspected to be of pups
  # using PCs of PCA coda rob
  # hclust algorithm
  tar_target(findk_ward_scats_tot_output, 
             clust_find_k_table_PCs(PCA_scats_tot_coda_rob,
                                    type = "scats",
                                    k = c(2:10),
                                    method = "ward.D2",
                                    object_type = "output", 
                                    file_name = "tot_PCs")),
  tar_target(findk_ward_scats_tot_file, 
             clust_find_k_table_PCs(PCA_scats_tot_coda_rob,
                                    type = "scats",
                                    k = c(2:10),
                                    method = "ward.D2",
                                    object_type = "file", 
                                    file_name = "tot_PCs")),
  tar_target(findk_ward_boxplot_scats_tot, 
             boxplot_clust_find_k_val(findk_ward_scats_tot_output,
                                      "scats", 
                                      file_name = "tot_PCs")),
  tar_target(findk_ward_means_scats_tot, 
             means_clust_find_k_val(findk_ward_scats_tot_output,
                                    "scats", 
                                    file_name = "tot_PCs")),
  # k = 4
  tar_target(clust_PCs_scats_tot_k4_ward_file, 
             clust_compo_PCs(PCA_scats_tot_coda_rob,
                             type = "scats",
                             k = 4,
                             method = "ward.D2",
                             "file",
                             "scats_tot_coda_rob_k4_ward")),
  tar_target(clust_PCs_scats_tot_k4_ward_output, 
             clust_compo_PCs(PCA_scats_tot_coda_rob,
                             type = "scats",
                             k = 4,
                             method = "ward.D2",
                             "output",
                             "scats_tot_coda_rob_k4_ward")),
  tar_target(boxplot_clust_PCs_scats_tot_k4_ward, 
             boxplot_compo_clust(clust_PCs_scats_tot_k4_ward_output,
                                 full_res_compo_scats,
                                 "scats_tot_PCs_k4_ward")),
  tar_target(barplot_clust_PCs_scats_tot_k4_ward, 
             barplot_clust(clust_PCs_scats_tot_k4_ward_output,
                           full_res_compo_scats,
                           "scats_tot_PCs_k4_ward")),
  tar_target(biplot_clust_PCs_tot_k4_scats,
             biplot_after_clust(PCA_scats_tot_coda_rob,
                                clust_PCs_scats_tot_k4_ward_output,
                                full_res_compo_scats,
                                "scats",
                                "PCs_tot_k4_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  # k = 2
  tar_target(clust_PCs_scats_tot_k2_ward_file, 
             clust_compo_PCs(PCA_scats_tot_coda_rob,
                             "scats",
                             k = 2,
                             method = "ward.D2",
                             "file",
                             "scats_tot_coda_rob_k2_ward")),
  tar_target(clust_PCs_scats_tot_k2_ward_output, 
             clust_compo_PCs(PCA_scats_tot_coda_rob,
                             "scats",
                             k = 2,
                             method = "ward.D2",
                             "output",
                             "scats_tot_coda_rob_k2_ward")),
  tar_target(clust_PCs_scats_tot_k2_stats, 
             stats_compo_clust(clust_PCs_scats_tot_k2_ward_output,
                               full_res_compo_scats, 
                               file_name = "scats_tot_PCs_k2")),
  tar_target(clust_PCs_scats_tot_k2_samples_table, 
             clust_samples(clust_PCs_scats_tot_k2_ward_output,
                           full_res_compo_scats, 
                           file_name = "scats_tot_PCs_k2")),
  tar_target(clust_PCs_scats_tot_k2_dendro_HPI01, 
             clust_compo_PCs_dendro_scats(PCA_scats_tot_coda_rob,
                                          full_res_compo_scats,
                                          method = "ward.D2", 
                                          k = 2, 
                                          colour = "HPI01", 
                                          file_name = "scats_tot_PCs")),
  tar_target(clust_PCs_scats_tot_k2_dendro_HPI_pup_nopup, 
             clust_compo_PCs_dendro_scats(PCA_scats_tot_coda_rob,
                                          full_res_compo_scats,
                                          method = "ward.D2", 
                                          k = 2, 
                                          colour = "HPI_pup_nopup", 
                                          file_name = "scats_tot_PCs")),
  tar_target(boxplot_clust_PCs_scats_tot_k2_ward,
             boxplot_compo_clust(clust_PCs_scats_tot_k2_ward_output,
                                 full_res_compo_scats,
                                 "scats_tot_PCs_k2_ward")),
  tar_target(barplot_clust_PCs_scats_tot_k2_ward, 
             barplot_clust(clust_PCs_scats_tot_k2_ward_output,
                           full_res_compo_scats,
                           "scats_tot_PCs_k2_ward")),
  tar_target(biplot_clust_PCs_scats_tot_k2,
             biplot_after_clust(PCA_scats_tot_coda_rob,
                                clust_PCs_scats_tot_k2_ward_output,
                                full_res_compo_scats,
                                "scats",
                                "PCs_tot_coda_rob_k2_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  tar_target(MWtest_clust_PCs_scats_tot_k2, 
             MWtest_clust_k2(clust_PCs_scats_tot_k2_ward_output,
                             full_res_compo_scats,
                             "scats_tot_PCs_coda_rob_k2_ward")),
  
  # k = 3
  tar_target(clust_PCs_scats_tot_k3_ward_file, 
             clust_compo_PCs(PCA_scats_tot_coda_rob,
                             "scats",
                             k = 3,
                             method = "ward.D2",
                             "file",
                             "scats_tot_coda_rob_k3_ward")),
  tar_target(clust_PCs_scats_tot_k3_ward_output, 
             clust_compo_PCs(PCA_scats_tot_coda_rob,
                             "scats",
                             k = 3,
                             method = "ward.D2",
                             "output",
                             "scats_tot_coda_rob_k3_ward")),
  tar_target(boxplot_clust_PCs_scats_tot_k3_ward, 
             boxplot_compo_clust(clust_PCs_scats_tot_k3_ward_output,
                                 full_res_compo_scats,
                                 "scats_tot_PCs_k3_ward")),
  tar_target(barplot_clust_PCs_scats_tot_k3_ward, 
             barplot_clust(clust_PCs_scats_tot_k3_ward_output,
                           full_res_compo_scats,
                           "scats_tot_PCs_k3_ward")),
  tar_target(biplot_clust_PCs_scats_tot_k3,
             biplot_after_clust(PCA_scats_tot_coda_rob,
                                clust_PCs_scats_tot_k3_ward_output,
                                full_res_compo_scats,
                                "scats",
                                "PCs_tot_coda_rob_k3_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  tar_target(clust_PCs_scats_tot_k3_dendro_clust, 
             clust_compo_PCs_dendro_scats(PCA_scats_tot_coda_rob,
                                          full_res_compo_scats,
                                          method = "ward.D2", 
                                          k = 3, 
                                          colour = "Cluster", 
                                          file_name = "scats_tot_PCs_rob")),
  tar_target(MWtest_clust_PCs_scats_tot_k3, 
             MWtest_clust_k3(clust_PCs_scats_tot_k3_ward_output,
                             full_res_compo_scats,
                             "scats_tot_PCs_coda_rob_k3_ward")),
  
  # deleting that suspected to be of pups
  # using PCs of PCA coda rob
  # hclust algorithm
  tar_target(findk_ward_scats_nopup_output, 
             clust_find_k_table_PCs(PCA_scats_nopup_coda_rob,
                                    type = "scats",
                                    k = c(2:10),
                                    method = "ward.D2",
                                    object_type = "output", 
                                    file_name = "nopup_PCs")),
  tar_target(findk_ward_scats_nopup_file, 
             clust_find_k_table_PCs(PCA_scats_nopup_coda_rob,
                                    type = "scats",
                                    k = c(2:10),
                                    method = "ward.D2",
                                    object_type = "file", 
                                    file_name = "nopup_PCs")),
  tar_target(findk_ward_boxplot_scats_nopup, 
             boxplot_clust_find_k_val(findk_ward_scats_nopup_output,
                                      "scats", 
                                      file_name = "nopup_PCs")),
  tar_target(findk_ward_means_scats_nopup, 
             means_clust_find_k_val(findk_ward_scats_nopup_output,
                                    "scats", 
                                    file_name = "nopup_PCs")),
  # k = 2
  tar_target(clust_PCs_scats_nopup_k2_ward_file, 
             clust_compo_PCs(PCA_scats_nopup_coda_rob,
                             "scats",
                             k = 2,
                             method = "ward.D2",
                             "file",
                             "scats_nopup_coda_rob_k2_ward")),
  tar_target(clust_PCs_scats_nopup_k2_ward_output, 
             clust_compo_PCs(PCA_scats_nopup_coda_rob,
                             "scats",
                             k = 2,
                             method = "ward.D2",
                             "output",
                             "scats_nopup_coda_rob_k2_ward")),
  tar_target(clust_PCs_scats_nopup_k2_dendro_site, 
             clust_compo_PCs_dendro_scats(PCA_scats_nopup_coda_rob,
                                          full_res_compo_scats_nopup,
                                          method = "ward.D2", 
                                          k = 2, 
                                          colour = "Site", 
                                          file_name = "scats_nopup_PCs")),
  tar_target(boxplot_clust_PCs_scats_nopup_k2_ward, 
             boxplot_compo_clust(clust_PCs_scats_nopup_k2_ward_output,
                                 full_res_compo_scats_nopup,
                                 "PCs_scats_nopup_k2_ward")),
  tar_target(barplot_clust_PCs_scats_nopup_k2_ward, 
             barplot_clust(clust_PCs_scats_nopup_k2_ward_output,
                           full_res_compo_scats_nopup,
                           "PCs_scats_nopup_k2_ward")),
  tar_target(biplot_clust_PCs_scats_nopup_k2,
             biplot_after_clust(PCA_scats_nopup_coda_rob,
                                clust_PCs_scats_nopup_k2_ward_output,
                                full_res_compo_scats_nopup,
                                "scats",
                                "PCs_nopup_coda_rob_k2_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  tar_target(MWtest_clust_PCs_scats_nopup_k2, 
             MWtest_clust_k2(clust_PCs_scats_nopup_k2_ward_output,
                             full_res_compo_scats_nopup,
                             "scats_nopup_PCs_coda_rob_k2_ward")),
  # k = 2 but with non-robust PCA
  tar_target(clust_PCs_norob_scats_nopup_k2_ward_file, 
             clust_compo_PCs(PCA_scats_nopup_coda_norob,
                             "scats",
                             k = 2,
                             method = "ward.D2",
                             "file",
                             "scats_nopup_coda_norob_k2_ward")),
  tar_target(clust_PCs_norob_scats_nopup_k2_ward_output, 
             clust_compo_PCs(PCA_scats_nopup_coda_norob,
                             "scats",
                             k = 2,
                             method = "ward.D2",
                             "output",
                             "scats_nopup_coda_rob_k2_ward")),
  tar_target(clust_PCs_norob_scats_nopup_k2_dendro_site, 
             clust_compo_PCs_dendro_scats(PCA_scats_nopup_coda_norob,
                                          full_res_compo_scats_nopup,
                                          method = "ward.D2", 
                                          k = 2, 
                                          colour = "Site", 
                                          file_name = "scats_nopup_PCs_norob")),
  tar_target(clust_PCs_norob_scats_nopup_k2_dendro_HPI01, 
             clust_compo_PCs_dendro_scats(PCA_scats_nopup_coda_norob,
                                          full_res_compo_scats_nopup,
                                          method = "ward.D2", 
                                          k = 2, 
                                          colour = "HPI01", 
                                          file_name = "scats_nopup_PCs_norob")),
  tar_target(boxplot_clust_PCs_norob_scats_nopup_k2_ward, 
             boxplot_compo_clust(clust_PCs_norob_scats_nopup_k2_ward_output,
                                 full_res_compo_scats_nopup,
                                 "PCs_norob_scats_nopup_k2_ward")),
  tar_target(barplot_PCs_norob_clust_scats_nopup_k2_ward, 
             barplot_clust(clust_PCs_norob_scats_nopup_k2_ward_output,
                           full_res_compo_scats_nopup,
                           "PCs_norob_scats_nopup_k2_ward")),
  tar_target(biplot_clust_PCs_norob_scats_nopup_k2,
             biplot_after_clust(PCA_scats_nopup_coda_rob,
                                clust_PCs_norob_scats_nopup_k2_ward_output,
                                full_res_compo_scats_nopup,
                                "scats",
                                "PCs_nopup_coda_norob_k2_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  tar_target(MWtest_clust_PCs_norob_scats_nopup_k2, 
             MWtest_clust_k2(clust_PCs_norob_scats_nopup_k2_ward_output,
                             full_res_compo_scats_nopup,
                             "scats_nopup_PCs_coda_norob_k2_ward")),
  
  # k = 3
  tar_target(clust_PCs_scats_nopup_k3_ward_file, 
             clust_compo_PCs(PCA_scats_nopup_coda_rob,
                             "scats",
                             k = 3,
                             method = "ward.D2",
                             "file",
                             "scats_nopup_coda_rob_k3_ward")),
  tar_target(clust_PCs_scats_nopup_k3_ward_output, 
             clust_compo_PCs(PCA_scats_nopup_coda_rob,
                             "scats",
                             k = 3,
                             method = "ward.D2",
                             "output",
                             "scats_nopup_coda_rob_k3_ward")),
  tar_target(clust_PCs_scats_nopup_k3_dendro_clust, 
             clust_compo_PCs_dendro_scats(PCA_scats_nopup_coda_rob,
                                          full_res_compo_scats_nopup,
                                          method = "ward.D2", 
                                          k = 3, 
                                          colour = "Cluster", 
                                          file_name = "scats_nopup_PCs_rob")),
  tar_target(boxplot_clust_PCs_scats_nopup_k3_ward, 
             boxplot_compo_clust(clust_PCs_scats_nopup_k3_ward_output,
                                 full_res_compo_scats_nopup,
                                 "PCs_scats_nopup_k3_ward")),
  tar_target(barplot_clust_PCs_scats_nopup_k3_ward, 
             barplot_clust(clust_PCs_scats_nopup_k3_ward_output,
                           full_res_compo_scats_nopup,
                           "PCs_scats_nopup_k3_ward")),
  tar_target(biplot_clust_PCs_scats_nopup_k3,
             biplot_after_clust(PCA_scats_nopup_coda_rob,
                                clust_PCs_scats_nopup_k3_ward_output,
                                full_res_compo_scats_nopup,
                                "scats",
                                "PCs_nopup_coda_rob_k3_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)), 
  
  # ------------------- BOTH FISH AND SCATS -------------------
  # using the clean dataset for fish and deleting scats suspected to be of pups
  # using PCs of PCA coda rob
  # hclust algorithm
  tar_target(findk_ward_fish_clean_scats_nopup_output, 
             clust_find_k_table_PCs(PCA_fish_clean_scats_nopup_coda_rob,
                                    type = "both",
                                    k = c(2:10),
                                    method = "ward.D2",
                                    object_type = "output", 
                                    file_name = "clean_nopup_PCs")),
  tar_target(findk_ward_fish_clean_scats_nopup_file, 
             clust_find_k_table_PCs(PCA_fish_clean_scats_nopup_coda_rob,
                                    type = "both",
                                    k = c(2:10),
                                    method = "ward.D2",
                                    object_type = "file", 
                                    file_name = "clean_nopup_PCs")),
  tar_target(findk_ward_boxplot_fish_clean_scats_nopup, 
             boxplot_clust_find_k_val(findk_ward_fish_clean_scats_nopup_output,
                                      "both", 
                                      file_name = "nopup_PCs")),
  tar_target(findk_ward_means_fish_clean_scats_nopup, 
             means_clust_find_k_val(findk_ward_fish_clean_scats_nopup_output,
                                    "both", 
                                    file_name = "clean_nopup_PCs")),
  # dendrogram with type 
  tar_target(clust_fish_clean_PCs_scats_nopup_dendro_type, 
             clust_compo_PCs_dendro_both(PCA_fish_clean_scats_nopup_coda_rob,
                                         fish_sp_means_clean_and_scats_nopup,
                                         method = "ward.D2", 
                                         k = 2, 
                                         colour = "type", 
                                         file_name = "both_clean_nopup_PCs")),
  # k = 2
  tar_target(clust_fish_clean_PCs_scats_nopup_k2_ward_file, 
             clust_compo_PCs(PCA_fish_clean_scats_nopup_coda_rob,
                             "both",
                             k = 2,
                             method = "ward.D2",
                             "file",
                             "both_clean_nopup_coda_rob_k2_ward")),
  tar_target(clust_fish_clean_PCs_scats_nopup_k2_ward_output, 
             clust_compo_PCs(PCA_fish_clean_scats_nopup_coda_rob,
                             "both",
                             k = 2,
                             method = "ward.D2",
                             "output",
                             "both_clean_nopup_coda_rob_k2_ward")),
  tar_target(boxplot_clust_fish_clean_PCs_scats_nopup_k2_ward, 
             boxplot_compo_clust(clust_fish_clean_PCs_scats_nopup_k2_ward_output,
                                 fish_sp_means_clean_and_scats_nopup,
                                 "both_PCs_clean_nopup_k2_ward")),
  tar_target(barplot_clust_fish_clean_PCs_scats_nopup_k2_ward, 
             barplot_clust(clust_fish_clean_PCs_scats_nopup_k2_ward_output,
                           fish_sp_means_clean_and_scats_nopup,
                           "both_PCs_clean_nopup_k2_ward")),
  tar_target(biplot_clust_fish_clean_PCs_scats_nopup_k2,
             biplot_after_clust(PCA_fish_clean_scats_nopup_coda_rob,
                                clust_fish_clean_PCs_scats_nopup_k2_ward_output,
                                fish_sp_means_clean_and_scats_nopup,
                                "both",
                                "PCs_clean_nopup_coda_rob_k2_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  tar_target(clust_fish_clean_PCs_scats_nopup_k2_dendro_cluster, 
             clust_compo_PCs_dendro_both(PCA_fish_clean_scats_nopup_coda_rob,
                                         fish_sp_means_clean_and_scats_nopup,
                                         method = "ward.D2", 
                                         k = 2, 
                                         colour = "Cluster", 
                                         file_name = "both_clean_nopup_PCs")),
  tar_target(MWtest_clust_fish_clean_PCs_scats_nopup_k2, 
             MWtest_clust_k2(clust_fish_clean_PCs_scats_nopup_k2_ward_output,
                             fish_sp_means_clean_and_scats_nopup,
                             "both_clean_nopup_PCs_coda_rob_k2_ward")),
  tar_target(biplot_clust_fish_clean_PCs_scats_nopup_k2_PC13,
             biplot_after_clust(PCA_fish_clean_scats_nopup_coda_rob,
                                clust_fish_clean_PCs_scats_nopup_k2_ward_output,
                                fish_sp_means_clean_and_scats_nopup,
                                "both",
                                "PCs_coda_rob_clean_nopup_k2_ward_PC13",
                                pcomp = c(1,3),
                                var.add.scaling = 2.5)),
  tar_target(biplot_clust_fish_clean_PCs_scats_nopup_k2_PC23,
             biplot_after_clust(PCA_fish_clean_scats_nopup_coda_rob,
                                clust_fish_clean_PCs_scats_nopup_k2_ward_output,
                                fish_sp_means_clean_and_scats_nopup,
                                "both",
                                "PCs_coda_rob_clean_nopup_k2_ward_PC23",
                                pcomp = c(2,3),
                                var.add.scaling = 2.5)),
  tar_target(biplot_clust_fish_clean_PCs_scats_nopup_k2_PC14,
             biplot_after_clust(PCA_fish_clean_scats_nopup_coda_rob,
                                clust_fish_clean_PCs_scats_nopup_k2_ward_output,
                                fish_sp_means_clean_and_scats_nopup,
                                "both",
                                "PCs_coda_rob_clean_nopup_k2_ward_PC14",
                                pcomp = c(1,4),
                                var.add.scaling = 2.5)),
  tar_target(biplot_clust_fish_clean_PCs_scats_nopup_k2_PC24,
             biplot_after_clust(PCA_fish_clean_scats_nopup_coda_rob,
                                clust_fish_clean_PCs_scats_nopup_k2_ward_output,
                                fish_sp_means_clean_and_scats_nopup,
                                "both",
                                "PCs_coda_rob_clean_nopup_k2_ward_PC24",
                                pcomp = c(2,4),
                                var.add.scaling = 2.5)),
  tar_target(biplot_clust_fish_clean_PCs_scats_nopup_k2_PC34,
             biplot_after_clust(PCA_fish_clean_scats_nopup_coda_rob,
                                clust_fish_clean_PCs_scats_nopup_k2_ward_output,
                                fish_sp_means_clean_and_scats_nopup,
                                "both",
                                "PCs_coda_rob_clean_nopup_k2_ward_PC34",
                                pcomp = c(3,4),
                                var.add.scaling = 2.5)),
  
  ###### with all scats 
  tar_target(findk_ward_fish_clean_scats_output, 
             clust_find_k_table_PCs(PCA_fish_clean_scats_coda_rob,
                                    type = "both",
                                    pup = TRUE,
                                    k = c(2:10),
                                    method = "ward.D2",
                                    object_type = "output", 
                                    file_name = "clean_PCs")),
  tar_target(findk_ward_fish_clean_scats_file, 
             clust_find_k_table_PCs(PCA_fish_clean_scats_coda_rob,
                                    type = "both",
                                    pup = TRUE,
                                    k = c(2:10),
                                    method = "ward.D2",
                                    object_type = "file", 
                                    file_name = "clean_PCs")),
  tar_target(findk_ward_boxplot_fish_clean_scats, 
             boxplot_clust_find_k_val(findk_ward_fish_clean_scats_output,
                                      "both", 
                                      file_name = "clean_PCs")),
  tar_target(findk_ward_means_fish_clean_scats, 
             means_clust_find_k_val(findk_ward_fish_clean_scats_output,
                                    "both", 
                                    file_name = "clean_PCs")),
  # dendrogram with types
  tar_target(clust_fish_clean_scats_PCs_rob_dendro_type, 
             clust_compo_PCs_dendro_both(PCA_fish_clean_scats_coda_rob,
                                         fish_sp_means_clean_and_scats,
                                         pup = TRUE,
                                         method = "ward.D2", 
                                         k = 2, 
                                         colour = "type", 
                                         file_name = "both_clean_PCs_rob")),
  # k = 2 with all scats
  tar_target(clust_fish_clean_scats_PCs_rob_k2_ward_file, 
             clust_compo_PCs(PCA_fish_clean_scats_coda_rob,
                             "both",
                             k = 2,
                             pup = TRUE,
                             method = "ward.D2",
                             "file",
                             "both_clean_coda_rob_k2_ward")),
  tar_target(clust_fish_clean_scats_PCs_rob_k2_ward_output, 
             clust_compo_PCs(PCA_fish_clean_scats_coda_rob,
                             "both",
                             k = 2,
                             pup = TRUE,
                             method = "ward.D2",
                             "output",
                             "both_clean_coda_rob_k2_ward")),
  tar_target(boxplot_clust_fish_clean_scats_PCs_rob_k2_ward, 
             boxplot_compo_clust(clust_fish_clean_scats_PCs_rob_k2_ward_output,
                                 fish_sp_means_clean_and_scats,
                                 "both_PCs_rob_clean_k2_ward")),
  tar_target(barplot_clust_fish_clean_scats_PCs_rob_k2_ward, 
             barplot_clust(clust_fish_clean_scats_PCs_rob_k2_ward_output,
                           fish_sp_means_clean_and_scats,
                           "both_PCs_rob_clean_k2_ward")),
  tar_target(biplot_clust_fish_clean_scats_PCs_rob_k2,
             biplot_after_clust(PCA_fish_clean_scats_coda_rob,
                                clust_fish_clean_scats_PCs_rob_k2_ward_output,
                                fish_sp_means_clean_and_scats,
                                "both",
                                "PCs_rob_coda_clean_k2_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)),
  tar_target(clust_fish_clean_scats_PCs_rob_k2_dendro_clust, 
             clust_compo_PCs_dendro_both(PCA_fish_clean_scats_coda_rob,
                                         fish_sp_means_clean_and_scats,
                                         method = "ward.D2", 
                                         k = 2, 
                                         colour = "Cluster", 
                                         file_name = "both_clean_PCs_rob")),
  tar_target(MWtest_clust_fish_clean_PCs_rob_scats_k2, 
             MWtest_clust_k2(clust_fish_clean_scats_PCs_rob_k2_ward_output,
                             fish_sp_means_clean_and_scats,
                             "both_clean_PCs_coda_rob_k2_ward")),
  
  # k = 3 with all scats
  tar_target(clust_fish_clean_PCs_scats_k3_ward_file, 
             clust_compo_PCs(PCA_fish_clean_scats_coda_rob,
                             "both",
                             k = 3,
                             pup = TRUE,
                             method = "ward.D2",
                             "file",
                             "both_clean_coda_rob_k3_ward")),
  tar_target(clust_fish_clean_PCs_scats_k3_ward_output, 
             clust_compo_PCs(PCA_fish_clean_scats_coda_rob,
                             "both",
                             k = 3,
                             pup = TRUE,
                             method = "ward.D2",
                             "output",
                             "both_clean_coda_rob_k3_ward")),
  tar_target(clust_fish_clean_PCs_scats_k3_ward_dendro_clust, 
             clust_compo_PCs_dendro_both(PCA_fish_clean_scats_coda_rob,
                                         fish_sp_means_clean_and_scats,
                                         pup = TRUE,
                                         method = "ward.D2", 
                                         k = 3, 
                                         colour = "Cluster", 
                                         file_name = "both_clean_PCs_rob")),
  tar_target(boxplot_clust_fish_clean_PCs_scats_k3_ward, 
             boxplot_compo_clust(clust_fish_clean_PCs_scats_k3_ward_output,
                                 fish_sp_means_clean_and_scats,
                                 "both_PCs_clean_k3_ward")),
  tar_target(barplot_clust_fish_clean_PCs_scats_k3_ward, 
             barplot_clust(clust_fish_clean_PCs_scats_k3_ward_output,
                           fish_sp_means_clean_and_scats,
                           "both_PCs_clean_k3_ward")),
  tar_target(biplot_clust_fish_clean_PCs_scats_k3,
             biplot_after_clust(PCA_fish_clean_scats_coda_rob,
                                clust_fish_clean_PCs_scats_k3_ward_output,
                                fish_sp_means_clean_and_scats,
                                "both",
                                "PCs_coda_rob_clean_k3_ward",
                                pcomp = c(1:2),
                                var.add.scaling = 2.5)), 
  tar_target(clust_fish_clean_scats_PCs_rob_k3_dendro_clust, 
             clust_compo_PCs_dendro_both(PCA_fish_clean_scats_coda_rob,
                                         fish_sp_means_clean_and_scats,
                                         pup = TRUE,
                                         method = "ward.D2", 
                                         k = 3, 
                                         colour = "Cluster", 
                                         file_name = "both_clean_PCs_rob"))
  
  
  
)
